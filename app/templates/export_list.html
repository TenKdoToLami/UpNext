<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>UpNext Library Export (List View - {{ now.strftime("%Y-%m-%d") }})</title>
	<style>
		body {
			font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
			background: #0c0c0e;
			padding: 20px;
			color: #e4e4e7;
		}

		h1 {
			text-align: center;
			margin-bottom: 30px;
			font-weight: 800;
			color: #fff;
		}

		.list-container {
			max-width: 1000px;
			margin: 0 auto;
			display: flex;
			flex-direction: column;
			gap: 20px;
		}

		.entry-card {
			background: #18181b;
			border-radius: 8px;
			box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.5);
			border: 1px solid #27272a;
			padding: 20px;
			display: flex;
			gap: 20px;
		}

		.cover-container {
			width: 100px;
			height: 150px;
			flex-shrink: 0;
			background: #27272a;
			border-radius: 4px;
			overflow: hidden;
		}

		.cover {
			width: 100%;
			height: 100%;
			object-fit: cover;
		}

		.no-cover {
			width: 100%;
			height: 100%;
			display: flex;
			align-items: center;
			justify-content: center;
			color: #52525b;
			font-size: 10px;
			text-align: center;
			background: #18181b;
		}

		.content-area {
			flex-grow: 1;
		}

		.header-row {
			display: flex;
			justify-content: space-between;
			align-items: flex-start;
			border-bottom: 1px solid #27272a;
			padding-bottom: 12px;
			margin-bottom: 12px;
		}

		.title {
			font-weight: 800;
			font-size: 20px;
			margin: 0;
			color: #fff;
			line-height: 1.2;
		}

		.authors {
			font-size: 13px;
			color: #a1a1aa;
			margin-top: 4px;
		}

		.details {
			margin-top: 10px;
		}

		.tag-group {
			display: flex;
			gap: 6px;
			flex-wrap: wrap;
		}

		.tag {
			padding: 4px 8px;
			border-radius: 4px;
			font-size: 11px;
			font-weight: bold;
			text-transform: uppercase;
			border: 1px solid rgba(255, 255, 255, 0.1);
			background: #27272a;
			color: #d4d4d8;
		}

		/* Status Colors */
		.status-Planning {
			border-color: #52525b;
			color: #a1a1aa;
		}

		.status-ReadingWatching {
			border-color: #0284c7;
			color: #38bdf8;
			background: #0c4a6e;
		}

		.status-Dropped {
			border-color: #b91c1c;
			color: #f87171;
			background: #450a0a;
		}

		.status-OnHold {
			border-color: #c2410c;
			color: #fb923c;
			background: #431407;
		}

		.status-Anticipating {
			border-color: #7e22ce;
			color: #c084fc;
			background: #3b0764;
		}

		.status-Completed {
			border-color: #047857;
			color: #34d399;
			background: #064e3b;
		}

		/* Other Tags */
		.type-tag {
			border-color: #4f46e5;
			color: #818cf8;
			background: #312e81;
		}

		.hidden-tag {
			border-color: #ea580c;
			color: #fb923c;
			background: #431407;
		}

		.rating-tag {
			border-color: #2563eb;
			color: #60a5fa;
			background: #172554;
		}

		.progress-text {
			font-size: 12px;
			color: #fbbf24;
			font-weight: 600;
			background: rgba(251, 191, 36, 0.1);
			padding: 3px 8px;
			border-radius: 4px;
			border: 1px solid rgba(251, 191, 36, 0.2);
		}

		.review-block {
			margin-top: 15px;
			padding: 12px;
			border-left: 3px solid #52525b;
			background: #27272a;
			font-size: 14px;
			color: #d4d4d8;
			font-style: italic;
			border-radius: 0 4px 4px 0;
		}

		.sub-title {
			font-weight: 700;
			margin-top: 16px;
			margin-bottom: 6px;
			font-size: 12px;
			text-transform: uppercase;
			color: #71717a;
			letter-spacing: 0.05em;
		}

		.children-list {
			list-style: none;
			padding: 0;
			margin: 0;
			font-size: 13px;
		}

		.child-item {
			background: #27272a;
			padding: 8px 12px;
			border-radius: 4px;
			border-bottom: 1px solid #3f3f46;
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 4px;
			color: #d4d4d8;
		}

		.link-group {
			display: flex;
			flex-wrap: wrap;
			gap: 8px;
			margin-top: 8px;
		}

		.link-item {
			font-size: 12px;
			color: #818cf8;
			text-decoration: none;
			border: 1px solid #4338ca;
			padding: 4px 10px;
			border-radius: 12px;
			background: rgba(99, 102, 241, 0.1);
			transition: all 0.2s;
		}

		.link-item:hover {
			background: rgba(99, 102, 241, 0.2);
			border-color: #6366f1;
			color: #fff;
		}

		p {
			margin: 0;
		}

		.text-body {
			color: #d4d4d8;
			font-size: 14px;
			line-height: 1.6;
		}
	</style>
</head>

<body>
	<h1>UpNext Library Export (List View - {{ now.strftime("%Y-%m-%d") }}) - {{ items|length }} Entries</h1>
	<div class="list-container">
		{% if not items %}
		<p style="text-align:center; color:#999; font-size:16px; margin-top:50px;">No entries match the selected
			filters.</p>
		{% endif %}

		{% for item in items %}
		<div class="entry-card">
			<!-- Cover -->
			<div class="cover-container">
				{% if 'coverUrl' in fields and item.coverUrl %}
				<img src="{{ item.coverUrl }}" class="cover">
				{% else %}
				<div class="no-cover">{% if 'coverUrl' in fields %}No Cover{% else %}N/A{% endif %}</div>
				{% endif %}
			</div>

			<!-- Content -->
			<div class="content-area">
				<div class="header-row">
					<div>
						<h2 class="title">{{ item.title|default('Untitled') }}</h2>
						<div class="authors">By: {{ item.authors|join(', ') if item.authors else (item.author if
							item.author else 'N/A') }}</div>
					</div>
					<div class="tag-group">
						{% if 'type' in fields %}
						<span class="tag type-tag">{{ item.type|default('Unknown') }}</span>
						{% endif %}
						{% if 'status' in fields %}
						{% set status_class = item.status|default('Unknown')|replace(' ', '') %}
						<span class="tag status-{{ status_class }}">{{ item.status|default('Unknown') }}</span>
						{% endif %}
						{% if 'isHidden' in fields and item.isHidden %}
						<span class="tag hidden-tag">HIDDEN</span>
						{% endif %}
					</div>
				</div>
				<div class="details">
					<!-- Rating & Review -->
					{% if 'rating' in fields and (item.rating or item.review) %}
					{% if item.rating or item.review %}
					<div class="review-block">
						{% if item.status in ['Completed', 'Anticipating'] and item.rating %}
						<span class="rating-tag tag" style="float: right; margin-left: 10px;">VERDICT: {{
							RATING_MAP.get(item.rating, 'N/A') }}</span>
						{% endif %}
						{% if item.review %}
						<p><strong>Personal Review:</strong> {{ item.review }}</p>
						{% endif %}
					</div>
					{% endif %}
					{% endif %}

					<!-- Progress -->
					{% if 'progress' in fields and item.progress %}
					<p class="sub-title">Current Progress: <span class="progress-text">{{ item.progress }}</span></p>
					{% endif %}

					<!-- Description -->
					{% if 'description' in fields and item.description %}
					<p class="sub-title">Synopsis:</p>
					<p style="font-size:13px; color:#444; margin-top:5px;">
						{{ item.description|replace('\n', '<br>')|safe }}
					</p>
					{% endif %}

					<!-- Context: Series/Universe -->
					{% if ('series' in fields and item.series) or ('universe' in fields and item.universe) %}
					<p class="sub-title">Context:</p>
					{% if 'series' in fields and item.series %}
					<p style="font-size:13px; color:#444; margin-top:5px;">
						Series/Collection: {{ item.series }}{{ ' #' + item.seriesNumber if item.seriesNumber else '' }}
					</p>
					{% endif %}
					{% if 'universe' in fields and item.universe %}
					<p style="font-size:13px; color:#444; margin-top:5px;">Universe: {{ item.universe }}</p>
					{% endif %}
					{% endif %}

					<!-- Children -->
					{% if 'children' in fields and item.children %}
					{% set child_label = 'Volumes' if item.type in ['Book', 'Manga'] else 'Seasons' %}
					<p class="sub-title">{{ child_label }}:</p>
					<ul class="children-list">
						{% for child in item.children %}
						<li class="child-item">
							<span>{{ child.title }}</span>
							{% set child_rating_text = RATING_MAP.get(child.rating, '') %}
							{% if child_rating_text %}
							<span style="color:#f59e0b; font-weight:bold;">({{ child_rating_text }})</span>
							{% endif %}
						</li>
						{% endfor %}
					</ul>
					{% endif %}

					<!-- External Links -->
					{% if 'externalLinks' in fields and item.externalLinks %}
					<p class="sub-title">External Links:</p>
					<div class="link-group">
						{% for link in item.externalLinks %}
						<a href="{{ link.url|default('#') }}" class="link-item" target="_blank">{{
							link.label|default('Link') }}</a>
						{% endfor %}
					</div>
					{% endif %}

				</div>
			</div>
		</div>
		{% endfor %}
	</div>
	<p style="text-align:center; margin-top: 30px; color:#999; font-size:12px;">Export generated by UpNext.</p>
</body>

</html>