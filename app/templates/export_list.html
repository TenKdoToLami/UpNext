<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>UpNext Library Export (List View - {{ now.strftime("%Y-%m-%d") }})</title>
	<link rel="stylesheet" href="css/export_list.css">
</head>

<body>
	<h1>UpNext Library Export (List View - {{ now.strftime("%Y-%m-%d") }}) - {{ items|length }} Entries</h1>
	<div class="list-container">
		{% if not items %}
		<p style="text-align:center; color:#999; font-size:16px; margin-top:50px;">No entries match the selected
			filters.</p>
		{% endif %}

		{% for item in items %}
		<div class="entry-card">
			<!-- Cover -->
			<div class="cover-container">
				{% if 'coverUrl' in fields and item.coverUrl %}
				<img src="{{ item.coverUrl }}" class="cover" loading="lazy">
				{% else %}
				<div class="no-cover">{% if 'coverUrl' in fields %}No Cover{% else %}N/A{% endif %}</div>
				{% endif %}
			</div>

			<!-- Content -->
			<div class="content-area">
				<div class="header-row">
					<div>
						<h2 class="title">{{ item.title|default('Untitled') }}</h2>
						<div class="authors">By: {{ item.authors|join(', ') if item.authors else (item.author if
							item.author else 'N/A') }}</div>
					</div>
					<div class="tag-group">
						{% if 'type' in fields %}
						<span class="tag type-tag">{{ item.type|default('Unknown') }}</span>
						{% endif %}
						{% if 'status' in fields %}
						{% set status_class = item.status|default('Unknown')|replace(' ', '') %}
						<span class="tag status-{{ status_class }}">{{ item.status|default('Unknown') }}</span>
						{% endif %}
						{% if 'isHidden' in fields and item.isHidden %}
						<span class="tag hidden-tag">HIDDEN</span>
						{% endif %}
					</div>
				</div>
				<div class="details">
					<!-- Rating & Review -->
					{% if 'rating' in fields and (item.rating or item.review) %}
					{% if item.rating or item.review %}
					<div class="review-block">
						{% if item.status in ['Completed', 'Anticipating'] and item.rating %}
						<span class="rating-tag tag" style="float: right; margin-left: 10px;">VERDICT: {{
							RATING_MAP.get(item.rating, 'N/A') }}</span>
						{% endif %}
						{% if item.review %}
						<p><strong>Personal Review:</strong> {{ item.review }}</p>
						{% endif %}
					</div>
					{% endif %}
					{% endif %}

					<!-- Progress -->
					{% if 'progress' in fields and item.progress %}
					<p class="sub-title">Current Progress: <span class="progress-text">{{ item.progress }}</span></p>
					{% endif %}

					<!-- Description -->
					{% if 'description' in fields and item.description %}
					<p class="sub-title">Synopsis:</p>
					<p style="font-size:13px; color:#444; margin-top:5px;">
						{{ item.description|replace('\n', '<br>')|safe }}
					</p>
					{% endif %}

					<!-- Context: Series/Universe -->
					{% if ('series' in fields and item.series) or ('universe' in fields and item.universe) %}
					<p class="sub-title">Context:</p>
					{% if 'series' in fields and item.series %}
					<p style="font-size:13px; color:#444; margin-top:5px;">
						Series/Collection: {{ item.series }}{{ ' #' + item.seriesNumber if item.seriesNumber else '' }}
					</p>
					{% endif %}
					{% if 'universe' in fields and item.universe %}
					<p style="font-size:13px; color:#444; margin-top:5px;">Universe: {{ item.universe }}</p>
					{% endif %}
					{% endif %}

					<!-- Children -->
					{% if 'children' in fields and item.children %}
					{% set child_label = 'Volumes' if item.type in ['Book', 'Manga'] else 'Seasons' %}
					<p class="sub-title">{{ child_label }}:</p>
					<ul class="children-list">
						{% for child in item.children %}
						<li class="child-item">
							<span>{{ child.title }}</span>
							{% set child_rating_text = RATING_MAP.get(child.rating, '') %}
							{% if child_rating_text %}
							<span style="color:#f59e0b; font-weight:bold;">({{ child_rating_text }})</span>
							{% endif %}
						</li>
						{% endfor %}
					</ul>
					{% endif %}

					<!-- External Links -->
					{% if 'externalLinks' in fields and item.externalLinks %}
					<p class="sub-title">External Links:</p>
					<div class="link-group">
						{% for link in item.externalLinks %}
						<a href="{{ link.url|default('#') }}" class="link-item" target="_blank">{{
							link.label|default('Link') }}</a>
						{% endfor %}
					</div>
					{% endif %}

				</div>
			</div>
		</div>
		{% endfor %}
	</div>
	<p style="text-align:center; margin-top: 30px; color:#999; font-size:12px;">Export generated by UpNext.</p>
</body>

</html>