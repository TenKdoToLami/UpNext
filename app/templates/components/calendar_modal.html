<!-- CALENDAR MODAL -->
<div id="calendarModal"
	class="fixed inset-0 z-[80] flex items-center justify-center bg-zinc-500/30 dark:bg-black/90 backdrop-blur-md hidden opacity-0 transition-opacity duration-200"
	onclick="if(event.target === this) closeCalendarModal()">
	<div class="bg-white dark:bg-[#0c0c0e] border border-zinc-200 dark:border-zinc-800 rounded-3xl w-full max-w-[95%] h-[90vh] overflow-hidden flex flex-col shadow-2xl transform scale-95 transition-all duration-200 animate-enter"
		id="calendarModalContent">

		<!-- Header -->
		<div
			class="px-6 py-5 border-b border-zinc-200 dark:border-zinc-800 flex items-center justify-between bg-white dark:bg-[#0c0c0e] relative">

			<!-- Left: Quick Navigation -->
			<div class="flex items-center w-1/3">
				<button id="btnCalToday" onclick="goToToday()"
					class="px-4 py-2 text-sm font-bold text-emerald-600 dark:text-emerald-400 bg-emerald-50 dark:bg-emerald-950/30 rounded-xl border border-emerald-200 dark:border-emerald-800 hover:bg-emerald-100 dark:hover:bg-emerald-950/50 transition-all flex items-center gap-2">
					<i data-lucide="calendar" class="w-4 h-4"></i>
					<span>Today</span>
				</button>
			</div>

			<!-- Center: Month Navigation (Visible in Month View only) -->
			<div id="monthNavNew" style="display: none;" class="items-center justify-center gap-2 w-1/3">
				<button onclick="navigateMonth(-1)"
					class="p-1.5 rounded-lg hover:bg-zinc-100 dark:hover:bg-zinc-800 text-zinc-400 hover:text-zinc-900 dark:hover:text-white transition-all">
					<i data-lucide="chevron-left" class="w-5 h-5"></i>
				</button>
				<h3 id="calendarMonthLabel" onclick="openMonthYearPicker()"
					class="text-lg font-heading font-bold text-zinc-800 dark:text-white hover:text-emerald-500 dark:hover:text-emerald-400 cursor-pointer transition-colors select-none min-w-[140px] text-center">
					--
				</h3>
				<button onclick="navigateMonth(1)"
					class="p-1.5 rounded-lg hover:bg-zinc-100 dark:hover:bg-zinc-800 text-zinc-400 hover:text-zinc-900 dark:hover:text-white transition-all">
					<i data-lucide="chevron-right" class="w-5 h-5"></i>
				</button>
			</div>

			<!-- Right: View Modes & Close -->
			<div class="flex items-center justify-end gap-3 shrink-0 w-1/3">
				<div
					class="flex p-1 rounded-xl bg-zinc-100 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 shrink-0">
					<button id="calViewMonth" onclick="setCalendarView('month')"
						class="px-4 py-1.5 rounded-lg text-xs font-bold transition-all bg-zinc-900 dark:bg-white text-white dark:text-black shadow-sm">
						Month
					</button>
					<button id="calViewUpcoming" onclick="setCalendarView('upcoming')"
						class="px-4 py-1.5 rounded-lg text-xs font-bold transition-all text-zinc-500 hover:text-zinc-900 dark:hover:text-white">
						Upcoming
					</button>
				</div>

				<div class="h-8 w-px bg-zinc-200 dark:bg-zinc-800 mx-1"></div>

				<button onclick="closeCalendarModal()"
					class="p-2 rounded-xl text-zinc-400 hover:text-zinc-900 dark:hover:text-white hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-all">
					<i data-lucide="x" class="w-5 h-5"></i>
				</button>
			</div>
		</div>

		<!-- Main content area -->
		<div class="flex-1 overflow-hidden relative">
			<!-- Month View Layout -->
			<div id="calendarMonthView" class="h-full flex flex-col absolute inset-0 z-10 bg-white dark:bg-[#0c0c0e]">
				<div class="flex-1 overflow-y-auto custom-scrollbar p-6">
					<!-- Weekday headers -->
					<div class="grid grid-cols-7 gap-3 mb-3">
						<div class="text-center text-[11px] font-bold text-zinc-400 uppercase tracking-wider">Mon</div>
						<div class="text-center text-[11px] font-bold text-zinc-400 uppercase tracking-wider">Tue</div>
						<div class="text-center text-[11px] font-bold text-zinc-400 uppercase tracking-wider">Wed</div>
						<div class="text-center text-[11px] font-bold text-zinc-400 uppercase tracking-wider">Thu</div>
						<div class="text-center text-[11px] font-bold text-zinc-400 uppercase tracking-wider">Fri</div>
						<div class="text-center text-[11px] font-bold text-amber-500 uppercase tracking-wider">Sat</div>
						<div class="text-center text-[11px] font-bold text-red-500 uppercase tracking-wider">Sun</div>
					</div>
					<!-- Grid populated by calendar.js -->
					<div id="calendarDaysGrid" class="grid grid-cols-7 gap-3 pb-6"></div>
				</div>
			</div>

			<!-- Upcoming View Layout -->
			<div id="calendarUpcomingView"
				class="h-full flex flex-col hidden absolute inset-0 z-10 bg-white dark:bg-[#0c0c0e]">
				<div id="calendarUpcomingList"
					class="flex-1 overflow-x-auto custom-scrollbar p-6 flex items-start gap-8">
					<!-- Items populated by calendar.js -->
				</div>
			</div>
		</div>

		<!-- Activity Sidebar (Day Detail) -->
		<div id="calendarDayDetail"
			class="absolute inset-y-0 right-0 w-80 bg-white dark:bg-zinc-900 border-l border-zinc-200 dark:border-zinc-800 transform translate-x-full transition-transform duration-300 z-10 flex flex-col hidden shadow-2xl">
			<div class="p-4 border-b border-zinc-200 dark:border-zinc-800 flex items-center justify-between">
				<h4 id="dayDetailDate" class="font-heading font-bold text-zinc-900 dark:text-white">--</h4>
				<button onclick="closeDayDetail()"
					class="p-1.5 rounded-lg text-zinc-400 hover:text-zinc-900 dark:hover:text-white hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-all">
					<i data-lucide="x" class="w-4 h-4"></i>
				</button>
			</div>
			<div id="dayDetailContent" class="flex-1 overflow-y-auto custom-scrollbar p-4 space-y-3"></div>
		</div>

		<!-- Action Trigger -->
		<button onclick="openAddEventModal()"
			class="absolute bottom-8 right-40 z-50 px-6 py-3 bg-zinc-900 dark:bg-white hover:bg-zinc-700 dark:hover:bg-zinc-200 text-white dark:text-black rounded-full text-sm font-bold transition-all shadow-2xl hover:scale-105 active:scale-95 flex items-center gap-2 group translate-x-1/2">
			<i data-lucide="plus" class="w-5 h-5 group-hover:rotate-90 transition-transform"></i>
			<span>Add Release</span>
		</button>

		<!-- Date Selection Overlay -->
		<div id="monthYearPicker"
			class="absolute inset-0 bg-white/95 dark:bg-zinc-950/95 backdrop-blur-xl z-20 hidden flex-col items-center justify-center">
			<div class="w-full max-w-md p-8 space-y-6">
				<h3 class="text-xl font-heading font-bold text-center text-zinc-900 dark:text-white">Select Month & Year
				</h3>
				<div class="flex items-center justify-center gap-4">
					<button onclick="changePickerYear(-1)"
						class="p-2 rounded-xl bg-zinc-100 dark:bg-zinc-800 hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-all">
						<i data-lucide="chevron-left" class="w-5 h-5 text-zinc-600 dark:text-zinc-400"></i>
					</button>
					<span id="pickerYearLabel"
						class="text-2xl font-bold text-zinc-900 dark:text-white w-24 text-center">--</span>
					<button onclick="changePickerYear(1)"
						class="p-2 rounded-xl bg-zinc-100 dark:bg-zinc-800 hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-all">
						<i data-lucide="chevron-right" class="w-5 h-5 text-zinc-600 dark:text-zinc-400"></i>
					</button>
				</div>
				<div id="pickerMonthGrid" class="grid grid-cols-4 gap-2"></div>
				<button onclick="closeMonthYearPicker()"
					class="w-full py-3 rounded-xl bg-zinc-100 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400 font-bold text-sm hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-all">
					Cancel
				</button>
			</div>
		</div>
	</div>
</div>

<!-- ENTRY FORM MODAL -->
<div id="addEventModal"
	class="fixed inset-0 z-[100] hidden flex items-center justify-center bg-black/50 backdrop-blur-sm animate-enter"
	onclick="if(event.target === this) closeAddEventModal()">
	<div
		class="bg-white dark:bg-[#121214] border border-zinc-200 dark:border-zinc-800 rounded-2xl w-full max-w-lg shadow-2xl overflow-hidden flex flex-col max-h-[90vh]">
		<div class="flex items-center justify-between p-5 border-b border-zinc-200 dark:border-zinc-800">
			<h3 id="addEventModalTitle" class="text-lg font-bold text-zinc-900 dark:text-white">Add New Release</h3>
			<button onclick="closeAddEventModal()"
				class="p-2 rounded-xl text-zinc-400 hover:text-zinc-900 dark:hover:text-white hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-all">
				<i data-lucide="x" class="w-5 h-5"></i>
			</button>
		</div>

		<div class="p-5 overflow-y-auto space-y-5">
			<div class="space-y-2 relative">
				<label class="block text-sm font-bold text-zinc-700 dark:text-zinc-300">Associated Title
					(Optional)</label>
				<div class="relative">
					<i data-lucide="search" class="absolute left-3 top-3 w-4 h-4 text-zinc-400"></i>
					<input type="text" id="addEventSearch" placeholder="Search for anime, manga, etc..."
						oninput="searchMediaItems(this.value)"
						class="w-full pl-10 pr-4 py-2.5 bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 rounded-xl focus:ring-2 focus:ring-emerald-500 outline-none transition-all text-sm">
				</div>
				<div id="addEventSuggestions"
					class="absolute left-0 right-0 top-full mt-1 bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 rounded-xl shadow-xl max-h-48 overflow-y-auto hidden z-30">
				</div>
				<div id="addEventSelectedItem"
					class="hidden items-center gap-3 p-3 bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-100 dark:border-emerald-800 rounded-xl">
					<img id="selectedItemCover" src="" class="w-8 h-10 rounded object-cover bg-zinc-200">
					<div class="flex-1 min-w-0">
						<h4 id="selectedItemTitle" class="font-bold text-sm text-zinc-900 dark:text-white truncate">
						</h4>
						<span id="selectedItemType" class="text-xs text-emerald-600 dark:text-emerald-400"></span>
					</div>
					<button onclick="clearSelectedMediaItem()"
						class="p-1 hover:bg-emerald-100 dark:hover:bg-emerald-800 rounded-full text-emerald-600 dark:text-emerald-400">
						<i data-lucide="x" class="w-4 h-4"></i>
					</button>
				</div>
			</div>

			<div class="space-y-2">
				<label class="block text-sm font-bold text-zinc-700 dark:text-zinc-300">Event Description <span
						class="text-red-500">*</span></label>
				<input type="text" id="addEventContent" required placeholder="e.g. Season 2 Premiere"
					class="w-full px-4 py-2.5 bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 rounded-xl focus:ring-2 focus:ring-emerald-500 outline-none transition-all text-sm">
			</div>

			<div class="space-y-2">
				<label class="block text-sm font-bold text-zinc-700 dark:text-zinc-300">Date <span
						class="text-red-500">*</span></label>
				<input type="date" id="addEventDate" required
					class="w-full px-4 py-2.5 bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 rounded-xl focus:ring-2 focus:ring-emerald-500 outline-none transition-all text-sm">
			</div>

			<div class="flex items-center gap-3 pt-1">
				<input type="checkbox" id="addEventTracked" checked
					class="w-4 h-4 text-emerald-500 rounded focus:ring-emerald-500 border-gray-300">
				<label for="addEventTracked" class="text-sm font-medium text-zinc-700 dark:text-zinc-300">Track this
					event (show in Upcoming view)</label>
			</div>
		</div>

		<div
			class="p-5 border-t border-zinc-200 dark:border-zinc-800 flex justify-between gap-3 bg-zinc-50/50 dark:bg-zinc-900/30">
			<button id="btnDeleteEvent" onclick="deleteEvent()"
				class="hidden px-4 py-2 text-red-500 hover:text-red-600 font-bold hover:bg-red-50 dark:hover:bg-red-900/20 rounded-xl transition-all text-sm">
				Delete
			</button>
			<div class="flex gap-3 ml-auto">
				<button onclick="closeAddEventModal()"
					class="px-4 py-2 font-bold text-zinc-500 hover:text-zinc-800 dark:text-zinc-400 dark:hover:text-white transition-colors text-sm">
					Cancel
				</button>
				<button onclick="submitNewEvent()"
					class="px-5 py-2 bg-emerald-500 hover:bg-emerald-600 text-white font-bold rounded-xl shadow-lg shadow-emerald-500/20 transition-all flex items-center gap-2 text-sm">
					<i data-lucide="check" class="w-4 h-4"></i>
					<span id="btnAddEventLabel">Create</span>
				</button>
			</div>
		</div>
	</div>
</div>
</div>