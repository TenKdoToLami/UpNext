<header class="sticky top-0 z-50 h-24 flex items-center justify-center pointer-events-none px-4">
	<!-- Glassmorphic Global Header -->
	<div
		class="pointer-events-auto bg-white/90 dark:bg-[#0c0c0e]/90 backdrop-blur-xl border border-zinc-200 dark:border-zinc-800/80 rounded-2xl shadow-2xl flex items-center p-2 gap-3 max-w-full relative transition-all duration-500 ease-in-out">

		<!-- Logo & Branding -->
		<div class="flex items-center gap-3 pl-2 pr-1 shrink-0">
			<img src="/static/img/logo.png" alt="UpNext" class="h-6 w-auto object-contain"
				onerror="this.style.display='none';">
			<span
				class="font-heading font-bold text-lg text-zinc-900 dark:text-white tracking-tight hidden sm:block">UpNext</span>
		</div>

		<!-- Mobile Search Trigger -->
		<button id="searchMobileBtn" onclick="toggleSearch()" aria-label="Open Search"
			class="flex lg:hidden p-2 rounded-lg text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white transition-all hover:bg-black/5 dark:hover:bg-white/5 shrink-0">
			<i data-lucide="search" class="w-4 h-4"></i>
		</button>

		<!-- Desktop Search Container -->
		<div id="searchBarContainer"
			class="hidden lg:flex items-center group lg:relative lg:w-48 lg:focus-within:absolute lg:focus-within:inset-0 lg:focus-within:w-full lg:focus-within:z-50 lg:focus-within:bg-white lg:dark:focus-within:bg-[#0c0c0e] lg:focus-within:rounded-2xl lg:focus-within:px-3 transition-all duration-300 ease-in-out shrink min-w-0 z-50 p-2 lg:p-0">

			<button onclick="document.activeElement.blur()" aria-label="Back"
				class="lg:group-focus-within:flex hidden p-2 mr-1 text-zinc-500 hover:text-zinc-900 dark:hover:text-white transition-all">
				<i data-lucide="arrow-left" class="w-5 h-5"></i>
			</button>

			<button onclick="toggleSearch()" aria-label="Back"
				class="lg:hidden p-2 mr-1 text-zinc-500 hover:text-zinc-900 dark:hover:text-white">
				<i data-lucide="arrow-left" class="w-5 h-5"></i>
			</button>

			<div class="relative w-full">
				<div
					class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-zinc-400 dark:text-zinc-500 group-focus-within:text-indigo-500 dark:group-focus-within:text-white transition-colors">
					<i data-lucide="search" class="w-4 h-4"></i>
				</div>
				<input type="text" id="searchInput" placeholder="Search library..."
					class="w-full bg-zinc-100 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl pl-9 pr-8 py-2 text-sm focus:outline-none focus:border-indigo-500 dark:focus:border-zinc-600 focus:ring-1 focus:ring-indigo-500 dark:focus:ring-zinc-600 transition-all placeholder:text-zinc-400 dark:placeholder:text-zinc-600 text-zinc-900 dark:text-white font-medium">
				<button id="clearSearchBtn" onpointerdown="clearSearch(); event.preventDefault();"
					aria-label="Clear search"
					class="absolute right-2 top-1/2 -translate-y-1/2 text-zinc-400 hover:text-zinc-900 dark:text-zinc-500 dark:hover:text-white hidden transition-colors">
					<i data-lucide="x" class="w-3 h-3"></i>
				</button>
			</div>
		</div>

		<div class="w-px h-8 bg-zinc-200 dark:bg-zinc-800 shrink-0 hidden lg:block"></div>

		<!-- Main Toolbelt -->
		<div class="flex items-center gap-2 shrink-0">
			<!-- View Controls (Desktop) -->
			<div
				class="hidden lg:flex items-center gap-1 bg-zinc-100 dark:bg-zinc-900/80 p-1 rounded-xl border border-zinc-200 dark:border-white/5">
				<div class="flex items-center gap-1">
					<button onclick="toggleDetails()"
						class="details-btn p-2 rounded-lg text-zinc-400 hover:text-zinc-900 dark:hover:text-white relative transition-all active:scale-90"
						title="Toggle Details">
						<i data-lucide="eye" class="w-4 h-4"></i>
					</button>
					<button onclick="toggleMultiSelect()"
						class="multiSelect-btn p-2 rounded-lg text-zinc-400 hover:text-zinc-900 dark:hover:text-white relative transition-all active:scale-90"
						title="Multi-Select Mode">
						<i data-lucide="list-checks" class="w-4 h-4"></i>
					</button>
					<button onclick="toggleHidden()"
						class="hidden-btn p-2 rounded-lg text-zinc-400 hover:text-zinc-900 dark:hover:text-white relative transition-all active:scale-90"
						title="Show Hidden Items">
						<i data-lucide="shield-off" class="w-4 h-4"></i>
					</button>
					<button onclick="toggleHiddenOnly()" id="hiddenOnlyBtn"
						class="hiddenOnly-btn hidden p-2 rounded-lg text-zinc-400 hover:text-red-500 transition-all active:scale-90"
						title="Show ONLY Hidden">
						<i data-lucide="shield-alert" class="w-4 h-4"></i>
					</button>
				</div>

				<button onclick="window.toggleTheme()"
					class="p-2 rounded-lg hover:bg-black/5 dark:hover:bg-white/10 text-zinc-400 dark:text-zinc-500 hover:text-zinc-900 dark:hover:text-white transition-all active:scale-90"
					title="Toggle Theme">
					<i id="themeIcon" data-lucide="sun" class="w-4 h-4"></i>
				</button>

				<div class="w-px h-4 bg-zinc-300 dark:bg-zinc-800 mx-0.5"></div>

				<div class="flex items-center gap-1">
					<button onclick="setViewMode('grid')"
						class="view-grid-btn p-2 rounded-lg transition-all text-zinc-400 hover:text-zinc-900 dark:text-zinc-500 dark:hover:text-white active:scale-90"
						title="Grid View">
						<i data-lucide="layout-grid" class="w-4 h-4"></i>
					</button>
					<button onclick="setViewMode('list')"
						class="view-list-btn p-2 rounded-lg transition-all text-zinc-400 hover:text-zinc-900 dark:text-zinc-500 dark:hover:text-white active:scale-90"
						title="List View">
						<i data-lucide="list" class="w-4 h-4"></i>
					</button>
				</div>
			</div>

			<!-- Sort & Controls Trigger -->
			<button id="sortMobileToggle" onclick="toggleSortMenu()"
				class="p-2.5 rounded-xl bg-zinc-100 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400 hover:text-zinc-900 dark:hover:text-white hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-all border border-zinc-200 dark:border-zinc-700 relative active:scale-95"
				title="Controls & Filters (O)">
				<i data-lucide="sliders-horizontal" class="w-4 h-4"></i>
				<span id="sortActiveIndicator"
					class="absolute top-2 right-2 w-1.5 h-1.5 bg-indigo-500 rounded-full hidden"></span>
			</button>

			<!-- Sort Menu Container -->
			<div id="sortMenuContainer"
				class="hidden flex-col absolute top-[calc(100%+12px)] right-0 bg-white/95 dark:bg-zinc-900/95 backdrop-blur-2xl border border-zinc-200 dark:border-zinc-800 p-4 rounded-2xl shadow-2xl min-w-[280px] max-w-[320px] max-h-[80vh] overflow-y-auto custom-scrollbar z-50 animate-in fade-in slide-in-from-top-2 duration-200 origin-top-right">

				<!-- Ordering Section -->
				<div
					class="text-[10px] font-black uppercase tracking-widest text-zinc-400 dark:text-zinc-500 mb-3 px-1 flex items-center gap-2">
					<i data-lucide="list-ordered" class="w-3 h-3"></i> Ordering
				</div>
				<div class="flex flex-col gap-3 mb-6">
					<div id="sortFieldFilters"
						class="flex items-center justify-between gap-1 p-1 bg-zinc-100 dark:bg-black/20 rounded-xl overflow-x-auto scrollbar-none whitespace-nowrap w-full">
					</div>
					<div id="sortDirectionFilters"
						class="grid grid-cols-2 gap-2 p-1 bg-zinc-100 dark:bg-black/20 rounded-xl"></div>
				</div>

				<!-- Mobile Filters -->
				<div class="xl:hidden">
					<div
						class="text-[10px] font-black uppercase tracking-widest text-zinc-400 dark:text-zinc-500 mb-3 px-1 flex items-center gap-2">
						<i data-lucide="filter" class="w-3 h-3"></i> Filters
					</div>
					<div class="flex flex-col gap-4 mb-6">
						<div id="typeFiltersMobileContainer">
							<div class="text-[9px] font-bold text-zinc-400 dark:text-zinc-500 uppercase px-1 mb-2">Type
							</div>
							<div id="typeFiltersMobile" class="grid grid-cols-2 gap-1.5 overflow-hidden"></div>
						</div>
						<div id="statusFiltersMobileContainer">
							<div class="text-[9px] font-bold text-zinc-400 dark:text-zinc-500 uppercase px-1 mb-2">
								Status</div>
							<div id="statusFiltersMobile" class="grid grid-cols-2 gap-1.5 overflow-hidden"></div>
						</div>
						<div id="ratingFiltersMobileContainer" class="hidden">
							<div class="text-[9px] font-bold text-zinc-400 dark:text-zinc-500 uppercase px-1 mb-2">
								Rating</div>
							<div id="ratingFiltersMobile" class="grid grid-cols-2 gap-1.5 overflow-hidden"></div>
						</div>
					</div>
				</div>

				<!-- Mobile Interface Tokens -->
				<div
					class="lg:hidden text-[10px] font-black uppercase tracking-widest text-zinc-400 dark:text-zinc-500 mb-3 px-1 flex items-center gap-2">
					<i data-lucide="wrench" class="w-3 h-3"></i> Interface
				</div>
				<div class="grid grid-cols-2 gap-2 mb-6 lg:hidden p-1 bg-zinc-100 dark:bg-black/20 rounded-xl">
					<button onclick="toggleDetails()"
						class="details-btn flex items-center gap-2 px-3 py-2.5 rounded-xl bg-zinc-200/50 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400 hover:text-white transition-all text-[10px] font-bold border border-zinc-200 dark:border-zinc-700 relative">
						<i data-lucide="eye" class="w-4 h-4"></i> Details
					</button>
					<button onclick="toggleMultiSelect()"
						class="multiSelect-btn flex items-center gap-2 px-3 py-2.5 rounded-xl bg-zinc-200/50 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400 hover:text-white transition-all text-[10px] font-bold border border-zinc-200 dark:border-zinc-700 relative">
						<i data-lucide="list-checks" class="w-4 h-4"></i> Multi
					</button>
					<button onclick="toggleHidden()"
						class="hidden-btn flex items-center gap-2 px-3 py-2.5 rounded-xl bg-zinc-200/50 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400 hover:text-white transition-all text-[10px] font-bold border border-zinc-200 dark:border-zinc-700 relative">
						<i data-lucide="shield-off" class="w-4 h-4"></i> Hidden
					</button>
					<button onclick="toggleHiddenOnly()"
						class="hiddenOnly-btn flex items-center gap-2 px-3 py-2.5 rounded-xl bg-zinc-200/50 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400 hover:text-red-500 transition-all text-[10px] font-bold border border-zinc-200 dark:border-zinc-700">
						<i data-lucide="shield-alert" class="w-4 h-4"></i> Only
					</button>
				</div>

				<!-- Mobile Layout Options -->
				<div
					class="lg:hidden text-[10px] font-black uppercase tracking-widest text-zinc-400 dark:text-zinc-500 mb-3 px-1 flex items-center gap-2">
					<i data-lucide="layout" class="w-3 h-3"></i> View Options
				</div>
				<div class="grid grid-cols-3 gap-2 mb-6 lg:hidden p-1 bg-zinc-100 dark:bg-black/20 rounded-xl">
					<button onclick="setViewMode('grid')"
						class="view-grid-btn p-2.5 rounded-lg text-zinc-400 hover:text-white flex items-center justify-center transition-all bg-zinc-200/50 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700">
						<i data-lucide="layout-grid" class="w-4 h-4"></i>
					</button>
					<button onclick="setViewMode('list')"
						class="view-list-btn p-2.5 rounded-lg text-zinc-400 hover:text-white flex items-center justify-center transition-all bg-zinc-200/50 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700">
						<i data-lucide="list" class="w-4 h-4"></i>
					</button>
					<button onclick="window.toggleTheme()"
						class="p-2.5 rounded-lg text-zinc-400 hover:text-white flex items-center justify-center transition-all bg-zinc-200/50 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700">
						<i data-lucide="sun" id="themeIconMobile" class="w-4 h-4"></i>
					</button>
				</div>

				<!-- Global Actions -->
				<div
					class="text-[10px] font-black uppercase tracking-widest text-zinc-400 dark:text-zinc-500 mb-3 px-1 flex items-center gap-2">
					<i data-lucide="cog" class="w-3 h-3"></i> System
				</div>
				<div class="grid grid-cols-2 gap-2 mt-2">
					<button onclick="openInfoModal()"
						class="flex items-center gap-2 px-3 py-2.5 rounded-xl bg-zinc-100 dark:bg-zinc-800 text-zinc-700 dark:text-zinc-300 hover:text-indigo-500 dark:hover:text-white transition-all text-xs font-bold border border-zinc-200 dark:border-zinc-700">
						<i data-lucide="info" class="w-4 h-4"></i> Info
					</button>
					<button onclick="window.openSettingsModal?.()"
						class="flex items-center gap-2 px-3 py-2.5 rounded-xl bg-zinc-100 dark:bg-zinc-800 text-zinc-700 dark:text-zinc-300 hover:text-indigo-500 dark:hover:text-white transition-all text-xs font-bold border border-zinc-200 dark:border-zinc-700">
						<i data-lucide="settings" class="w-4 h-4"></i> Settings
					</button>
				</div>
				<div class="mt-2 text-center">
					<button onclick="openExportModal()"
						class="w-full flex items-center justify-center gap-2 px-3 py-2.5 rounded-xl bg-zinc-100 dark:bg-zinc-800 text-zinc-700 dark:text-zinc-300 hover:text-indigo-500 dark:hover:text-white transition-all text-xs font-bold border border-zinc-200 dark:border-zinc-700">
						<i data-lucide="download" class="w-4 h-4"></i> Export Library
					</button>
				</div>
			</div>

			<div class="w-px h-8 bg-zinc-200 dark:bg-zinc-800 shrink-0 hidden md:block"></div>

			<!-- Quick Actions Segment -->
			<div class="flex items-center gap-2 pl-1 md:pl-0">
				<button onclick="window.openCalendarModal?.()" id="calendarBtn"
					class="bg-zinc-100 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-300 hover:text-white hover:bg-emerald-500 dark:hover:bg-emerald-600 p-2.5 rounded-xl flex items-center justify-center transition-all border border-zinc-200 dark:border-zinc-700 active:scale-95 shadow-sm"
					title="Release Calendar (C)">
					<i data-lucide="calendar" class="w-4 h-4"></i>
				</button>
				<button onclick="window.openStatsModal()" id="statsBtn"
					class="flex bg-zinc-100 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-300 hover:text-white hover:bg-indigo-500 dark:hover:bg-indigo-500 p-2.5 rounded-xl items-center justify-center transition-all border border-zinc-200 dark:border-zinc-700 active:scale-95 shadow-sm"
					title="Library Stats (S)">
					<i data-lucide="pie-chart" class="w-4 h-4"></i>
				</button>
				<button onclick="openModal()"
					class="bg-zinc-900 dark:bg-white text-white dark:text-black hover:bg-zinc-800 dark:hover:bg-zinc-100 px-5 py-2.5 rounded-xl flex items-center gap-2 text-sm font-black transition-all shadow-xl active:scale-95 whitespace-nowrap"
					title="Add New Item (N)">
					<i data-lucide="plus" class="w-5 h-5"></i>
					<span class="hidden sm:inline uppercase tracking-widest">Add</span>
				</button>
			</div>
		</div>
	</div>
</header>