<div id="settingsModal"
	class="fixed inset-0 z-[95] flex items-center justify-center bg-zinc-500/30 dark:bg-black/90 backdrop-blur-md hidden opacity-0 transition-opacity duration-200"
	onclick="if(event.target === this) closeSettingsModal()">
	<div class="bg-white dark:bg-[#0c0c0e] border border-zinc-200 dark:border-zinc-800 rounded-3xl w-full max-w-2xl max-h-[85vh] overflow-hidden flex flex-col shadow-2xl transform scale-95 transition-all duration-200 animate-enter"
		id="settingsModalContent">

		<div
			class="px-8 py-6 border-b border-zinc-200 dark:border-zinc-800 flex justify-between items-center bg-white dark:bg-[#0c0c0e]">
			<h2
				class="text-xl font-heading font-bold text-zinc-900 dark:text-white tracking-wide flex items-center gap-2">
				<i data-lucide="settings" class="w-5 h-5 text-indigo-500 dark:text-indigo-400"></i> Settings
			</h2>
			<button onclick="closeSettingsModal()"
				class="text-zinc-400 hover:text-red-500 dark:hover:text-white transition-colors">
				<i data-lucide="x" class="w-5 h-5"></i>
			</button>
		</div>

		<div
			class="flex items-center gap-4 px-8 pt-6 pb-2 bg-zinc-50 dark:bg-zinc-950/30 border-b border-zinc-200 dark:border-zinc-800 overflow-x-auto scrollbar-none">
			<button onclick="switchSettingsTab('features')" id="tab-features"
				class="settings-tab-btn active px-4 py-2 rounded-xl text-xs font-bold uppercase tracking-wider transition-all bg-white dark:bg-zinc-900 shadow-sm border border-zinc-200 dark:border-zinc-800 text-indigo-500">
				General
			</button>
			<button onclick="switchSettingsTab('content')" id="tab-content"
				class="settings-tab-btn px-4 py-2 rounded-xl text-xs font-bold uppercase tracking-wider transition-all text-zinc-500 dark:text-zinc-400 hover:text-zinc-900 dark:hover:text-white hover:bg-white dark:hover:bg-zinc-900 border border-transparent hover:border-zinc-200 dark:hover:border-zinc-800">
				Content
			</button>
			<button onclick="switchSettingsTab('tags')" id="tab-tags"
				class="settings-tab-btn px-4 py-2 rounded-xl text-xs font-bold uppercase tracking-wider transition-all text-zinc-500 dark:text-zinc-400 hover:text-zinc-900 dark:hover:text-white hover:bg-white dark:hover:bg-zinc-900 border border-transparent hover:border-zinc-200 dark:hover:border-zinc-800">
				Tags
			</button>
			<button onclick="switchSettingsTab('other')" id="tab-other"
				class="settings-tab-btn px-4 py-2 rounded-xl text-xs font-bold uppercase tracking-wider transition-all text-zinc-500 dark:text-zinc-400 hover:text-zinc-900 dark:hover:text-white hover:bg-white dark:hover:bg-zinc-900 border border-transparent hover:border-zinc-200 dark:hover:border-zinc-800">
				other
			</button>
		</div>

		<div class="p-8 overflow-y-auto custom-scrollbar flex-1 space-y-8 bg-zinc-50 dark:bg-zinc-950/30">

			<div id="settings-features" class="settings-panel space-y-6">
				<div id="settings-features-container" class="space-y-6"></div>
			</div>

			<div id="settings-content" class="settings-panel hidden space-y-6">
				<div class="space-y-6">
					<div>
						<h3 class="text-sm font-bold uppercase tracking-widest text-zinc-500 dark:text-zinc-400 mb-4">
							Active Media Types
						</h3>
						<div class="grid grid-cols-2 gap-3" id="typeVisibilityContainer">
						</div>
					</div>

					<div class="border-t border-zinc-200 dark:border-zinc-800 pt-6">
						<h3 class="text-sm font-bold uppercase tracking-widest text-zinc-500 dark:text-zinc-400 mb-4">
							Active Statuses
						</h3>
						<div class="grid grid-cols-2 gap-3" id="statusVisibilityContainer">
						</div>
					</div>
				</div>
			</div>

			<div id="settings-tags" class="settings-panel hidden space-y-6">
				<div class="space-y-4">
					<div class="flex items-center justify-between">
						<h3 class="text-sm font-bold uppercase tracking-widest text-zinc-500 dark:text-zinc-400">Manage
							Tags</h3>
					</div>
					<div id="settings-tags-container" class="space-y-3">
					</div>
				</div>
			</div>

			<div id="settings-other" class="settings-panel hidden space-y-6">
				<div class="space-y-4">
					<h3 class="text-sm font-bold uppercase tracking-widest text-zinc-500 dark:text-zinc-400 mb-2">
						App Connections & System
					</h3>

					<div
						class="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl p-4 flex items-center justify-between">
						<div>
							<div class="font-bold text-zinc-900 dark:text-white flex items-center gap-2">
								<i data-lucide="database" class="w-4 h-4 text-indigo-500"></i>
								Auto Select Last Active Database
							</div>
							<div class="text-xs text-zinc-500 dark:text-zinc-400 mt-1 ml-6">Skip database selection
								screen on
								startup
							</div>
						</div>
						<label class="relative inline-flex items-center cursor-pointer">
							<input type="checkbox" class="sr-only peer" id="setting-autoLaunchDb"
								onchange="window.toggleAutoLaunchSetting(this.checked)">
							<div
								class="w-11 h-6 bg-zinc-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 dark:peer-focus:ring-indigo-800 rounded-full peer dark:bg-zinc-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-indigo-600">
							</div>
						</label>
					</div>

					<div class="border-t border-zinc-200 dark:border-zinc-800 pt-6 mt-6">
						<h3
							class="text-sm font-bold uppercase tracking-widest text-zinc-500 dark:text-zinc-400 mb-4 flex items-center gap-2">
							<i data-lucide="key" class="w-4 h-4 text-amber-500"></i>
							External Data Connections
						</h3>
						<div
							class="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl p-6 space-y-6">
							<div>
								<div class="flex items-center justify-between mb-2">
									<label
										class="text-xs font-bold text-zinc-500 dark:text-zinc-400 uppercase tracking-wider block">
										TMDB API Key
									</label>
									<span
										class="px-2 py-0.5 bg-amber-100 dark:bg-amber-500/10 text-amber-600 dark:text-amber-400 text-[10px] font-bold rounded uppercase">Required
										for Movies</span>
								</div>
								<div class="flex gap-2">
									<input type="password" id="setting-tmdbApiKey"
										placeholder="Enter your TMDB API key..."
										class="flex-1 bg-zinc-50 dark:bg-black border border-zinc-200 dark:border-zinc-800 rounded-lg text-sm px-3 py-2.5 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:text-white placeholder-zinc-400 font-mono transition-all">
								</div>
								<p class="text-[11px] text-zinc-500 dark:text-zinc-400 mt-1">
									Get free key at <a href="https://www.themoviedb.org/settings/api" target="_blank"
										class="text-indigo-500 hover:underline">themoviedb.org</a>.
								</p>
							</div>

							<div>
								<div class="flex items-center justify-between mb-2">
									<label
										class="text-xs font-bold text-zinc-500 dark:text-zinc-400 uppercase tracking-wider block">
										Comic Vine API Key
									</label>
									<span
										class="px-2 py-0.5 bg-amber-100 dark:bg-amber-500/10 text-amber-600 dark:text-amber-400 text-[10px] font-bold rounded uppercase">Required
										for Comics</span>
								</div>
								<div class="flex gap-2">
									<input type="password" id="setting-comicvineApiKey"
										placeholder="Enter your Comic Vine API key..."
										class="flex-1 bg-zinc-50 dark:bg-black border border-zinc-200 dark:border-zinc-800 rounded-lg text-sm px-3 py-2.5 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:text-white placeholder-zinc-400 font-mono transition-all">
								</div>
								<p class="text-[11px] text-zinc-500 dark:text-zinc-400 mt-1">
									Get free key at <a href="https://comicvine.gamespot.com/api/" target="_blank"
										class="text-indigo-500 hover:underline">comicvine.gamespot.com</a>.
								</p>
							</div>

							<div>
								<div class="flex items-center justify-between mb-2">
									<label
										class="text-xs font-bold text-zinc-500 dark:text-zinc-400 uppercase tracking-wider block">
										Google Books API Key
									</label>
									<span
										class="px-2 py-0.5 bg-zinc-100 dark:bg-zinc-800 text-zinc-500 dark:text-zinc-400 text-[10px] font-bold rounded uppercase">Optional</span>
								</div>
								<div class="flex gap-2">
									<input type="password" id="setting-googlebooksApiKey"
										placeholder="Enter your Google Books API key..."
										class="flex-1 bg-zinc-50 dark:bg-black border border-zinc-200 dark:border-zinc-800 rounded-lg text-sm px-3 py-2.5 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:text-white placeholder-zinc-400 font-mono transition-all">
								</div>
								<p class="text-[11px] text-zinc-500 dark:text-zinc-400 mt-1">
									Increases rate limits for Google Books search. Get it at <a
										href="https://console.cloud.google.com/apis/credentials" target="_blank"
										class="text-indigo-500 hover:underline">Google Cloud Console</a>.
								</p>
							</div>

						</div>
					</div>

					<div class="border-t border-zinc-200 dark:border-zinc-800 pt-6 mt-6">
						<h3
							class="text-sm font-bold uppercase tracking-widest text-zinc-500 dark:text-zinc-400 mb-4 flex items-center gap-2">
							<i data-lucide="list-filter" class="w-4 h-4 text-emerald-500"></i>
							Primary Search Sources
						</h3>
						<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
							<div
								class="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl p-4">
								<div class="flex items-center gap-2 mb-3">
									<i data-lucide="sparkles" class="w-4 h-4 text-pink-500"></i>
									<span
										class="text-xs font-bold uppercase text-zinc-500 dark:text-zinc-400">Anime</span>
								</div>
								<div class="space-y-2" id="priority-anime-container">
									<label class="flex items-center gap-2 cursor-pointer group">
										<input type="radio" name="priority-anime" value="anilist"
											class="text-indigo-600 focus:ring-indigo-500 bg-zinc-100 dark:bg-zinc-800 border-zinc-300 dark:border-zinc-700"
											checked>
										<span
											class="text-sm text-zinc-700 dark:text-zinc-300 font-medium group-hover:text-indigo-500 transition-colors">AniList</span>
									</label>
									<label class="flex items-center gap-2 cursor-pointer group">
										<input type="radio" name="priority-anime" value="tmdb"
											class="text-indigo-600 focus:ring-indigo-500 bg-zinc-100 dark:bg-zinc-800 border-zinc-300 dark:border-zinc-700">
										<span
											class="text-sm text-zinc-700 dark:text-zinc-300 font-medium group-hover:text-indigo-500 transition-colors">TMDB</span>
									</label>
									<label class="flex items-center gap-2 cursor-pointer group">
										<input type="radio" name="priority-anime" value="tvmaze"
											class="text-indigo-600 focus:ring-indigo-500 bg-zinc-100 dark:bg-zinc-800 border-zinc-300 dark:border-zinc-700">
										<span
											class="text-sm text-zinc-700 dark:text-zinc-300 font-medium group-hover:text-indigo-500 transition-colors">TVMaze</span>
									</label>
								</div>
							</div>

							<div
								class="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl p-4">
								<div class="flex items-center gap-2 mb-3">
									<i data-lucide="book" class="w-4 h-4 text-orange-500"></i>
									<span
										class="text-xs font-bold uppercase text-zinc-500 dark:text-zinc-400">Manga</span>
								</div>
								<div class="space-y-2" id="priority-manga-container">
									<label class="flex items-center gap-2 cursor-pointer group">
										<input type="radio" name="priority-manga" value="mangadex"
											class="text-indigo-600 focus:ring-indigo-500 bg-zinc-100 dark:bg-zinc-800 border-zinc-300 dark:border-zinc-700"
											checked>
										<span
											class="text-sm text-zinc-700 dark:text-zinc-300 font-medium group-hover:text-indigo-500 transition-colors">MangaDex</span>
									</label>
									<label class="flex items-center gap-2 cursor-pointer group">
										<input type="radio" name="priority-manga" value="anilist"
											class="text-indigo-600 focus:ring-indigo-500 bg-zinc-100 dark:bg-zinc-800 border-zinc-300 dark:border-zinc-700">
										<span
											class="text-sm text-zinc-700 dark:text-zinc-300 font-medium group-hover:text-indigo-500 transition-colors">AniList</span>
									</label>
								</div>
							</div>

							<div
								class="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl p-4">
								<div class="flex items-center gap-2 mb-3">
									<i data-lucide="book-open" class="w-4 h-4 text-emerald-500"></i>
									<span
										class="text-xs font-bold uppercase text-zinc-500 dark:text-zinc-400">Books</span>
								</div>
								<div class="space-y-2" id="priority-book-container">
									<label class="flex items-center gap-2 cursor-pointer group">
										<input type="radio" name="priority-book" value="openlibrary"
											class="text-indigo-600 focus:ring-indigo-500 bg-zinc-100 dark:bg-zinc-800 border-zinc-300 dark:border-zinc-700"
											checked>
										<span
											class="text-sm text-zinc-700 dark:text-zinc-300 font-medium group-hover:text-indigo-500 transition-colors">OpenLibrary</span>
									</label>
									<label class="flex items-center gap-2 cursor-pointer group">
										<input type="radio" name="priority-book" value="googlebooks"
											class="text-indigo-600 focus:ring-indigo-500 bg-zinc-100 dark:bg-zinc-800 border-zinc-300 dark:border-zinc-700">
										<span
											class="text-sm text-zinc-700 dark:text-zinc-300 font-medium group-hover:text-indigo-500 transition-colors">Google
											Books</span>
									</label>
									<label class="flex items-center gap-2 cursor-pointer group">
										<input type="radio" name="priority-book" value="comicvine"
											class="text-indigo-600 focus:ring-indigo-500 bg-zinc-100 dark:bg-zinc-800 border-zinc-300 dark:border-zinc-700">
										<span
											class="text-sm text-zinc-700 dark:text-zinc-300 font-medium group-hover:text-indigo-500 transition-colors">Comic
											Vine</span>
									</label>
								</div>
							</div>

							<div
								class="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl p-4">
								<div class="flex items-center gap-2 mb-3">
									<i data-lucide="tv" class="w-4 h-4 text-blue-500"></i>
									<span
										class="text-xs font-bold uppercase text-zinc-500 dark:text-zinc-400">Series</span>
								</div>
								<div class="space-y-2" id="priority-series-container">
									<label class="flex items-center gap-2 cursor-pointer group">
										<input type="radio" name="priority-series" value="tmdb"
											class="text-indigo-600 focus:ring-indigo-500 bg-zinc-100 dark:bg-zinc-800 border-zinc-300 dark:border-zinc-700"
											checked>
										<span
											class="text-sm text-zinc-700 dark:text-zinc-300 font-medium group-hover:text-indigo-500 transition-colors">TMDB</span>
									</label>
									<label class="flex items-center gap-2 cursor-pointer group">
										<input type="radio" name="priority-series" value="tvmaze"
											class="text-indigo-600 focus:ring-indigo-500 bg-zinc-100 dark:bg-zinc-800 border-zinc-300 dark:border-zinc-700">
										<span
											class="text-sm text-zinc-700 dark:text-zinc-300 font-medium group-hover:text-indigo-500 transition-colors">TVMaze</span>
									</label>
									<label class="flex items-center gap-2 cursor-pointer group">
										<input type="radio" name="priority-series" value="anilist"
											class="text-indigo-600 focus:ring-indigo-500 bg-zinc-100 dark:bg-zinc-800 border-zinc-300 dark:border-zinc-700">
										<span
											class="text-sm text-zinc-700 dark:text-zinc-300 font-medium group-hover:text-indigo-500 transition-colors">AniList</span>
									</label>
								</div>
							</div>

							<div
								class="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl p-4">
								<div class="flex items-center gap-2 mb-3">
									<i data-lucide="film" class="w-4 h-4 text-purple-500"></i>
									<span
										class="text-xs font-bold uppercase text-zinc-500 dark:text-zinc-400">Movies</span>
								</div>
								<div class="space-y-2" id="priority-movie-container">
									<label class="flex items-center gap-2 cursor-pointer group">
										<input type="radio" name="priority-movie" value="tmdb"
											class="text-indigo-600 focus:ring-indigo-500 bg-zinc-100 dark:bg-zinc-800 border-zinc-300 dark:border-zinc-700"
											checked>
										<span
											class="text-sm text-zinc-700 dark:text-zinc-300 font-medium group-hover:text-indigo-500 transition-colors">TMDB</span>
									</label>
									<label class="flex items-center gap-2 cursor-pointer group">
										<input type="radio" name="priority-movie" value="anilist"
											class="text-indigo-600 focus:ring-indigo-500 bg-zinc-100 dark:bg-zinc-800 border-zinc-300 dark:border-zinc-700">
										<span
											class="text-sm text-zinc-700 dark:text-zinc-300 font-medium group-hover:text-indigo-500 transition-colors">AniList</span>
									</label>
								</div>
							</div>
						</div>
					</div>

					<div class="border-t border-zinc-200 dark:border-zinc-800 pt-6 mt-6">
						<h3
							class="text-sm font-bold uppercase tracking-widest text-zinc-500 dark:text-zinc-400 mb-4 flex items-center gap-2">
							<i data-lucide="monitor" class="w-4 h-4 text-indigo-500"></i>
							System Behavior
						</h3>
						<div class="space-y-3">
							<div
								class="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl p-4 flex items-center justify-between">
								<div>
									<div class="font-bold text-zinc-900 dark:text-white">Open Window on Launch</div>
									<div class="text-xs text-zinc-500 dark:text-zinc-400 mt-1">Open main window when
										starting from Tray</div>
								</div>
								<label class="relative inline-flex items-center cursor-pointer">
									<input type="checkbox" class="sr-only peer" id="setting-openWindowOnStart"
										onchange="window.toggleOpenWindowOnStart(this.checked)">
									<div
										class="w-11 h-6 bg-zinc-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 dark:peer-focus:ring-indigo-800 rounded-full peer dark:bg-zinc-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-indigo-600">
									</div>
								</label>
							</div>

							<div
								class="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl p-4 flex items-center justify-between">
								<div>
									<div class="font-bold text-zinc-900 dark:text-white">Tray Click Behavior</div>
									<div class="text-xs text-zinc-500 dark:text-zinc-400 mt-1">Action when clicking the
										system tray icon</div>
								</div>
								<select id="setting-trayClickAction" onchange="window.setTrayClickAction(this.value)"
									class="bg-zinc-50 dark:bg-black border border-zinc-200 dark:border-zinc-800 rounded-lg text-sm px-3 py-1.5 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:text-white">
									<option value="native">Open App Window</option>
									<option value="browser">Open in Browser</option>
								</select>
							</div>

							<div
								class="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl p-4 flex items-center justify-between">
								<div>
									<div class="font-bold text-zinc-900 dark:text-white">Close Window Behavior</div>
									<div class="text-xs text-zinc-500 dark:text-zinc-400 mt-1">What happens when you
										close the window</div>
								</div>
								<select id="setting-closeBehavior" onchange="window.setCloseBehavior(this.value)"
									class="bg-zinc-50 dark:bg-black border border-zinc-200 dark:border-zinc-800 rounded-lg text-sm px-3 py-1.5 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:text-white">
									<option value="minimize">Minimize to Tray</option>
									<option value="exit">Exit Completely</option>
								</select>
							</div>
						</div>
					</div>

					<div
						class="bg-zinc-100 dark:bg-zinc-900/50 rounded-xl p-4 border border-zinc-200 dark:border-zinc-800/50 flex items-center justify-between">
						<div class="text-xs text-zinc-500 dark:text-zinc-400 flex items-center gap-2">
							<i data-lucide="arrow-left-right" class="w-4 h-4"></i>
							<span>Return to library selection screen.</span>
						</div>
						<button onclick="window.restartToDbSelect()"
							class="px-3 py-1.5 bg-zinc-200 dark:bg-zinc-800 text-zinc-700 dark:text-zinc-300 rounded-lg text-xs font-bold hover:bg-indigo-500 hover:text-white transition-all shadow-sm">
							Switch Database
						</button>
					</div>
				</div>
			</div>

		</div>

		<div
			class="px-8 py-4 border-t border-zinc-200 dark:border-zinc-800 bg-white dark:bg-[#0c0c0e] flex justify-end gap-3">
			<button onclick="closeSettingsModal()"
				class="px-6 py-2 rounded-lg bg-zinc-100 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400 font-bold text-sm hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors">
				Cancel
			</button>
			<button onclick="window.saveSettingsAndClose()"
				class="px-6 py-2 rounded-lg bg-indigo-600 text-white font-bold text-sm hover:bg-indigo-700 transition-colors shadow-lg shadow-indigo-500/20">
				Save Changes
			</button>
		</div>
	</div>
</div>