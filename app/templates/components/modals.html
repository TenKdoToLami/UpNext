<!-- INFO MODAL -->
<div id="infoModal"
	class="fixed inset-0 z-[90] flex items-center justify-center bg-zinc-500/30 dark:bg-black/90 backdrop-blur-md hidden opacity-0 transition-opacity duration-200"
	onclick="if(event.target === this) closeInfoModal()">
	<div class="bg-white dark:bg-[#0c0c0e] border border-zinc-200 dark:border-zinc-800 rounded-3xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col shadow-2xl transform scale-95 transition-all duration-200 animate-enter"
		id="infoModalContent">
		<div
			class="px-8 py-6 border-b border-zinc-200 dark:border-zinc-800 flex justify-between items-center bg-white dark:bg-[#0c0c0e]">
			<h2
				class="text-xl font-heading font-bold text-zinc-900 dark:text-white tracking-wide flex items-center gap-2">
				<i data-lucide="info" class="w-5 h-5 text-indigo-500 dark:text-indigo-400"></i> UpNext Guide & Project
				Info
			</h2>
			<button onclick="closeInfoModal()"
				class="text-zinc-400 hover:text-red-500 dark:hover:text-white transition-colors"><i data-lucide="x"
					class="w-5 h-5"></i></button>
		</div>
		<div class="p-8 overflow-y-auto custom-scrollbar flex-1 space-y-8 bg-zinc-50 dark:bg-zinc-950/30">

			<div class="space-y-4 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2 text-black dark:text-zinc-200">
				<!-- PROJECT & CREATOR -->
				<div class="space-y-4 border-b border-zinc-200 dark:border-zinc-800 pb-4">
					<button onclick="document.getElementById('creatorGuide').classList.toggle('hidden')"
						class="w-full flex items-center justify-between text-left group">
						<h3 class="text-sm font-bold uppercase tracking-widest text-indigo-500 dark:text-indigo-400">
							Project & Creator</h3>
						<i data-lucide="chevron-down"
							class="w-4 h-4 text-zinc-400 group-hover:text-indigo-500 transition-colors"></i>
					</button>

					<div id="creatorGuide" class="space-y-4 animate-enter pt-2">
						<div
							class="bg-indigo-500/10 border border-indigo-500/20 rounded-2xl p-5 relative overflow-hidden group">
							<div
								class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity">
								<i data-lucide="zap" class="w-16 h-16 text-indigo-500"></i>
							</div>
							<div class="relative z-10">
								<h4 class="text-indigo-400 font-bold mb-1 flex items-center gap-2">
									TenKdoToLami <span
										class="text-[10px] bg-indigo-500 text-white px-1.5 py-0.5 rounded uppercase tracking-tighter shadow-sm shadow-indigo-500/50">Lead
										Chaotic Dev</span>
								</h4>
								<p class="text-[11px] text-zinc-400 leading-relaxed mb-4 italic">
									"I coded this hot pile of mess in a fever dream of glassmorphism and Python.
									It was <strong>majorly vibe coded</strong> and held together by pure spite and
									beautiful CSS.
									If it works, it's a miracle; if it doesn't, it's a feature."
								</p>
								<div class="flex gap-2">
									<a href="https://github.com/TenKdoToLami" target="_blank"
										class="flex items-center gap-2 px-3 py-2 rounded-lg bg-indigo-500 text-white text-[10px] font-bold hover:bg-indigo-600 transition-all shadow-lg shadow-indigo-500/20">
										<i data-lucide="user" class="w-3 h-3"></i> GitHub Profile
									</a>
									<a href="https://github.com/TenKdoToLami/UpNext" target="_blank"
										class="flex items-center gap-2 px-3 py-2 rounded-lg bg-zinc-800 dark:bg-zinc-700 text-white text-[10px] font-bold hover:bg-zinc-700 dark:hover:bg-zinc-600 transition-all">
										<i data-lucide="github" class="w-3 h-3"></i> Repository
									</a>
								</div>
							</div>
						</div>
					</div>
				</div>

				<!-- SEARCH GUIDE -->
				<div class="space-y-2 border-b border-zinc-200 dark:border-zinc-800 pb-4">
					<button onclick="document.getElementById('searchGuide').classList.toggle('hidden')"
						class="w-full flex items-center justify-between text-left group">
						<h3 class="text-sm font-bold uppercase tracking-widest text-indigo-500 dark:text-indigo-400">
							Search Guide</h3>
						<i data-lucide="chevron-down"
							class="w-4 h-4 text-zinc-400 group-hover:text-indigo-500 transition-colors"></i>
					</button>

					<div id="searchGuide" class="hidden space-y-3 text-sm animate-enter pt-2">
						<p class="leading-relaxed opacity-90">
							By default, the search bar finds items by <strong>Title</strong> or <strong>Alternative
								Titles</strong>.
						</p>
						<div
							class="bg-zinc-100 dark:bg-zinc-900/50 p-3 rounded-lg border border-zinc-200 dark:border-zinc-800">
							<p class="text-xs mb-2 opacity-80">To filter by specific fields, use prefixes:</p>
							<ul class="space-y-1.5 font-mono text-xs">
								<li><span class="text-indigo-600 dark:text-indigo-400">series=</span>"Name"</li>
								<li><span class="text-emerald-600 dark:text-emerald-400">universe=</span>"Name"</li>
								<li><span class="text-amber-600 dark:text-amber-400">author=</span>"Name"</li>
							</ul>
							<div class="mt-2 flex flex-wrap gap-2 text-[10px] opacity-80">
								<span class="italic opacity-70">Try it:</span>
								<button onclick="setSearch('universe=&quot;MCU&quot;')"
									class="bg-zinc-200 dark:bg-zinc-800 px-1.5 py-0.5 rounded hover:bg-emerald-500 hover:text-white transition-colors cursor-pointer text-emerald-600 dark:text-emerald-400 font-mono">universe="MCU"</button>
								<button onclick="setSearch('type=Anime')"
									class="bg-zinc-200 dark:bg-zinc-800 px-1.5 py-0.5 rounded hover:bg-indigo-500 hover:text-white transition-colors cursor-pointer text-indigo-600 dark:text-indigo-400 font-mono">type=Anime</button>
							</div>
						</div>
					</div>
				</div>

				<!-- INTERFACE CONTROLS -->
				<div class="space-y-2 border-b border-zinc-200 dark:border-zinc-800 pb-4">
					<button onclick="document.getElementById('interfaceGuide').classList.toggle('hidden')"
						class="w-full flex items-center justify-between text-left group">
						<h3 class="text-sm font-bold uppercase tracking-widest text-zinc-500 dark:text-zinc-400">
							Interface Controls</h3>
						<i data-lucide="chevron-down"
							class="w-4 h-4 text-zinc-400 group-hover:text-zinc-300 transition-colors"></i>
					</button>

					<div id="interfaceGuide" class="hidden space-y-3 text-sm animate-enter pt-2">
						<ul class="grid grid-cols-[80px,1fr] gap-x-3 gap-y-4 items-center">
							<li class="contents">
								<div class="flex gap-1.5 items-center justify-center">
									<div
										class="bg-zinc-100 dark:bg-zinc-800 p-1.5 rounded-md h-8 w-8 flex items-center justify-center">
										<i data-lucide="layout-grid" class="w-3.5 h-3.5 text-zinc-500"></i>
									</div>
									<div
										class="bg-zinc-100 dark:bg-zinc-800 p-1.5 rounded-md h-8 w-8 flex items-center justify-center border-b-2 border-indigo-500">
										<i data-lucide="list" class="w-3.5 h-3.5 text-zinc-900 dark:text-white"></i>
									</div>
								</div>
								<div class="text-xs"><strong>View Modes:</strong> Toggle between Grid and List view. The
									active mode is highlighted with a border.</div>
							</li>
							<li class="contents">
								<div class="flex gap-1.5 items-center justify-center">
									<div
										class="bg-zinc-100 dark:bg-zinc-800 p-1.5 rounded-md h-8 w-8 flex items-center justify-center text-zinc-400">
										<i data-lucide="eye" class="w-4 h-4"></i>
									</div>
									<div
										class="bg-zinc-100 dark:bg-zinc-800 p-1.5 rounded-md h-8 w-8 flex items-center justify-center relative text-zinc-900 dark:text-white">
										<i data-lucide="eye" class="w-4 h-4"></i>
										<span
											class="absolute top-1.5 right-1.5 w-1.5 h-1.5 bg-indigo-500 rounded-full"></span>
									</div>
								</div>
								<div class="text-xs"><strong>Toggle Details:</strong> Show/hide info. A <span
										class="text-indigo-500 font-bold">dot</span> means active.</div>
							</li>
							<li class="contents">
								<div
									class="bg-zinc-100 dark:bg-zinc-900 p-1.5 rounded-md h-8 w-8 mx-auto flex items-center justify-center">
									<i data-lucide="pie-chart" class="w-4 h-4 text-zinc-600 dark:text-zinc-400"></i>
								</div>
								<div class="text-xs"><strong>Library Stats:</strong> Open the visual dashboard for data
									insights.</div>
							</li>
							<li class="contents">
								<div class="flex gap-1.5 items-center justify-center">
									<div
										class="bg-zinc-100 dark:bg-zinc-800 p-1.5 rounded-md h-8 w-8 flex items-center justify-center text-zinc-400">
										<i data-lucide="list-checks" class="w-4 h-4"></i>
									</div>
									<div
										class="bg-zinc-100 dark:bg-zinc-800 p-1.5 rounded-md h-8 w-8 flex items-center justify-center relative text-zinc-900 dark:text-white">
										<i data-lucide="list-checks" class="w-4 h-4"></i>
										<span
											class="absolute top-1.5 right-1.5 w-1.5 h-1.5 bg-emerald-500 rounded-full"></span>
									</div>
								</div>
								<div class="text-xs"><strong>Multi-Select:</strong> Select multiple filters
									simultaneously. <span class="text-emerald-500 font-bold">Green dot</span> means
									active.</div>
							</li>
							<li class="contents">
								<div class="flex gap-1.5 items-center justify-center">
									<div
										class="bg-zinc-100 dark:bg-zinc-800 p-1.5 rounded-md h-8 w-8 flex items-center justify-center text-zinc-400">
										<i data-lucide="shield-off" class="w-4 h-4"></i>
									</div>
									<div
										class="bg-zinc-100 dark:bg-zinc-800 p-1.5 rounded-md h-8 w-8 flex items-center justify-center relative text-zinc-900 dark:text-white">
										<i data-lucide="shield-off" class="w-4 h-4"></i>
										<span
											class="absolute top-1.5 right-1.5 w-1.5 h-1.5 bg-red-500 rounded-full"></span>
									</div>
								</div>
								<div class="text-xs"><strong>Show Hidden:</strong> Display hidden entries alongside
									others. <span class="text-red-500 font-bold">Red dot</span> means active.</div>
							</li>
							<li class="contents">
								<div class="flex gap-1.5 items-center justify-center">
									<div
										class="bg-zinc-100 dark:bg-zinc-800 p-1.5 rounded-md h-8 w-8 flex items-center justify-center text-zinc-400">
										<i data-lucide="shield-alert" class="w-4 h-4"></i>
									</div>
									<div
										class="bg-red-500 p-1.5 rounded-md h-8 w-8 flex items-center justify-center text-white shadow-sm shadow-red-500/20">
										<i data-lucide="shield-alert" class="w-4 h-4"></i>
									</div>
								</div>
								<div class="text-xs"><strong>Only Hidden:</strong> Filter the view to show <em>only</em>
									hidden items. The toggled state is highlighted in <span
										class="text-red-500 font-bold">red</span>.</div>
							</li>
							<li class="contents">
								<div class="flex gap-1.5 items-center justify-center">
									<div
										class="bg-zinc-100 dark:bg-zinc-800 p-2 rounded-md h-8 w-8 flex items-center justify-center text-amber-500">
										<i data-lucide="sun" class="w-4 h-4"></i>
									</div>
									<div
										class="bg-zinc-800 p-2 rounded-md h-8 w-8 flex items-center justify-center text-blue-400">
										<i data-lucide="moon" class="w-4 h-4"></i>
									</div>
								</div>
								<div class="text-xs"><strong>Theme Toggle:</strong> Switch between Light (Sun) and Dark
									(Moon) modes.</div>
							</li>
						</ul>
					</div>
				</div>

				<!-- DEFINITIONS -->
				<div class="space-y-2 border-b border-zinc-200 dark:border-zinc-800 pb-4">
					<button onclick="document.getElementById('definitionsGuide').classList.toggle('hidden')"
						class="w-full flex items-center justify-between text-left group">
						<h3 class="text-sm font-bold uppercase tracking-widest text-emerald-500 dark:text-emerald-400">
							Definitions</h3>
						<i data-lucide="chevron-down"
							class="w-4 h-4 text-zinc-400 group-hover:text-emerald-500 transition-colors"></i>
					</button>

					<div id="definitionsGuide" class="hidden space-y-6 text-sm animate-enter pt-2">

						<!-- Status -->
						<div class="space-y-2">
							<h4 class="text-xs font-bold uppercase opacity-70">Status</h4>
							<div
								class="bg-zinc-100 dark:bg-zinc-900/50 p-3 rounded-lg border border-zinc-200 dark:border-zinc-800">
								<ul class="text-xs space-y-2">
									<li class="flex justify-between"><span
											class="font-bold text-blue-500">Planning</span> <span class="opacity-70">Not
											started yet</span></li>
									<li class="flex justify-between gap-4"><span
											class="font-bold text-fuchsia-500">Anticipating</span> <span
											class="opacity-70 text-right">Partly finished, waiting for release</span>
									</li>
									<li class="flex justify-between"><span class="font-bold text-amber-500">Reading /
											Watching</span> <span class="opacity-70">In progress</span></li>
									<li class="flex justify-between"><span
											class="font-bold text-emerald-500">Completed</span> <span
											class="opacity-70">Finished completely</span></li>
									<li class="flex justify-between"><span class="font-bold text-zinc-500">On
											Hold</span> <span class="opacity-70">Paused temporarily</span></li>
									<li class="flex justify-between"><span class="font-bold text-red-500">Dropped</span>
										<span class="opacity-70">Stopped permanently</span>
									</li>
								</ul>
							</div>
						</div>

						<!-- Ratings -->
						<div class="space-y-2">
							<h4 class="text-xs font-bold uppercase opacity-70">Ratings</h4>
							<div
								class="bg-zinc-100 dark:bg-zinc-900/50 p-3 rounded-lg border border-zinc-200 dark:border-zinc-800">
								<ul class="text-xs space-y-2">
									<li class="flex justify-between items-center">
										<span class="font-bold text-emerald-500">Masterpiece</span>
										<div class="flex gap-0.5"><i data-lucide="star"
												class="w-3 h-3 fill-emerald-500 text-emerald-500"></i><i
												data-lucide="star"
												class="w-3 h-3 fill-emerald-500 text-emerald-500"></i><i
												data-lucide="star"
												class="w-3 h-3 fill-emerald-500 text-emerald-500"></i><i
												data-lucide="star"
												class="w-3 h-3 fill-emerald-500 text-emerald-500"></i></div>
									</li>
									<li class="text-[10px] opacity-70 text-right -mt-1 italic">Great in all regards</li>

									<li class="flex justify-between items-center mt-2">
										<span class="font-bold text-blue-500">Good</span>
										<div class="flex gap-0.5"><i data-lucide="star"
												class="w-3 h-3 fill-blue-500 text-blue-500"></i><i data-lucide="star"
												class="w-3 h-3 fill-blue-500 text-blue-500"></i><i data-lucide="star"
												class="w-3 h-3 fill-blue-500 text-blue-500"></i><i data-lucide="star"
												class="w-3 h-3 text-zinc-300 dark:text-zinc-700"></i></div>
									</li>
									<li class="text-[10px] opacity-70 text-right -mt-1 italic">Something enjoyable</li>

									<li class="flex justify-between items-center mt-2">
										<span class="font-bold text-amber-500">Ok</span>
										<div class="flex gap-0.5"><i data-lucide="star"
												class="w-3 h-3 fill-amber-500 text-amber-500"></i><i data-lucide="star"
												class="w-3 h-3 fill-amber-500 text-amber-500"></i><i data-lucide="star"
												class="w-3 h-3 text-zinc-300 dark:text-zinc-700"></i><i
												data-lucide="star" class="w-3 h-3 text-zinc-300 dark:text-zinc-700"></i>
										</div>
									</li>
									<li class="text-[10px] opacity-70 text-right -mt-1 italic">Just "meh"</li>

									<li class="flex justify-between items-center mt-2">
										<span class="font-bold text-red-500">Bad</span>
										<div class="flex gap-0.5"><i data-lucide="star"
												class="w-3 h-3 fill-red-500 text-red-500"></i><i data-lucide="star"
												class="w-3 h-3 text-zinc-300 dark:text-zinc-700"></i><i
												data-lucide="star"
												class="w-3 h-3 text-zinc-300 dark:text-zinc-700"></i><i
												data-lucide="star" class="w-3 h-3 text-zinc-300 dark:text-zinc-700"></i>
										</div>
									</li>
									<li class="text-[10px] opacity-70 text-right -mt-1 italic">Unwatchable / Unreadable
									</li>
								</ul>
							</div>
						</div>

						<!-- Media Types -->
						<div class="space-y-2">
							<h4 class="text-xs font-bold uppercase opacity-70">Media Types</h4>
							<ul class="space-y-2 text-xs opacity-90">
								<li><strong class="text-violet-500">Anime:</strong> All animated works (TV, Movies,
									Western, Donghua).</li>
								<li><strong class="text-pink-500">Manga:</strong> All comics (Manga, Manhwa, Manhua,
									Graphic Novels).</li>
								<li><strong class="text-blue-500">Book:</strong> Novels, Non-fiction, Light Novels,
									Audiobooks.</li>
								<li><strong class="text-red-500">Movie:</strong> Live-action films, shorts.</li>
								<li><strong class="text-amber-500">Series:</strong> Live-action TV shows, dramas.</li>
							</ul>
						</div>

					</div>
				</div>

				<!-- STATISTICS GUIDE -->
				<div class="space-y-2 border-b border-zinc-200 dark:border-zinc-800 pb-4">
					<button onclick="document.getElementById('statsGuide').classList.toggle('hidden')"
						class="w-full flex items-center justify-between text-left group">
						<h3 class="text-sm font-bold uppercase tracking-widest text-indigo-500 dark:text-indigo-400">
							Library Statistics</h3>
						<i data-lucide="chevron-down"
							class="w-4 h-4 text-zinc-400 group-hover:text-indigo-500 transition-colors"></i>
					</button>

					<div id="statsGuide" class="hidden space-y-3 text-sm animate-enter pt-2">
						<p class="leading-relaxed opacity-90">
							The <strong>Library Stats</strong> portal provides advanced data visualizations:
						</p>
						<ul class="list-disc list-inside space-y-1 text-xs opacity-80">
							<li><strong>Type Distribution:</strong> Visual breakdown of your media library.</li>
							<li><strong>Status Breakdown:</strong> Track your progress from Planning to Completion.</li>
							<li><strong>Rating Distribution:</strong> Analyze your overall tastes and verdicts.</li>
							<li><strong>Library Growth:</strong> Follow your collection's expansion over time.</li>
						</ul>
					</div>
				</div>

				<!-- DATA MANAGEMENT -->
				<div class="space-y-2 border-b border-zinc-200 dark:border-zinc-800 pb-4">
					<button onclick="document.getElementById('dataGuide').classList.toggle('hidden')"
						class="w-full flex items-center justify-between text-left group">
						<h3 class="text-sm font-bold uppercase tracking-widest text-amber-500 dark:text-amber-400">Data
							Management</h3>
						<i data-lucide="chevron-down"
							class="w-4 h-4 text-zinc-400 group-hover:text-amber-500 transition-colors"></i>
					</button>

					<div id="dataGuide" class="hidden flex gap-4 items-start animate-enter text-sm mt-3">
						<div
							class="shrink-0 bg-amber-100 dark:bg-amber-500/10 p-2 rounded-lg text-amber-600 dark:text-amber-500">
							<i data-lucide="download" class="w-5 h-5"></i>
						</div>
						<div>
							<p class="leading-relaxed opacity-90 mb-2">Backups are crucial. Use the download button in
								the header to access export options:</p>
							<ul class="list-disc list-inside space-y-1 text-xs opacity-80">
								<li><strong>Full Export:</strong> Complete backup (Code + DB + Images).</li>
								<li><strong>Visual Export:</strong> Beautiful HTML grids/lists.</li>
								<li><strong>Raw Data:</strong> JSON/CSV/XML for data analysis.</li>
							</ul>
						</div>
					</div>
				</div>

				<!-- CORE DOCUMENTATION -->
				<div class="space-y-2 pt-2">
					<button onclick="document.getElementById('docsGuide').classList.toggle('hidden')"
						class="w-full flex items-center justify-between text-left group">
						<h3 class="text-sm font-bold uppercase tracking-widest text-zinc-500">
							Core Documentation</h3>
						<i data-lucide="chevron-down"
							class="w-4 h-4 text-zinc-400 group-hover:text-zinc-300 transition-colors"></i>
					</button>

					<div id="docsGuide" class="hidden space-y-3 animate-enter pt-3">
						<div class="grid grid-cols-1 gap-3">
							<a href="https://github.com/TenKdoToLami/UpNext/blob/main/README.md" target="_blank"
								class="flex items-center gap-4 p-4 rounded-xl bg-white dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 hover:border-indigo-500 transition-all group">
								<div
									class="shrink-0 w-10 h-10 rounded-full bg-indigo-50 dark:bg-indigo-500/10 flex items-center justify-center text-indigo-500">
									<i data-lucide="file-text" class="w-5 h-5"></i>
								</div>
								<div>
									<h4
										class="text-xs font-bold text-zinc-900 dark:text-white group-hover:text-indigo-500 transition-colors">
										README.md</h4>
									<p class="text-[10px] text-zinc-500 dark:text-zinc-400 leading-tight">Project
										overview, features, and setup instructions.</p>
								</div>
							</a>

							<a href="https://github.com/TenKdoToLami/UpNext/blob/main/ARCHITECTURE.md" target="_blank"
								class="flex items-center gap-4 p-4 rounded-xl bg-white dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 hover:border-emerald-500 transition-all group">
								<div
									class="shrink-0 w-10 h-10 rounded-full bg-emerald-50 dark:bg-emerald-500/10 flex items-center justify-center text-emerald-500">
									<i data-lucide="map" class="w-5 h-5"></i>
								</div>
								<div>
									<h4
										class="text-xs font-bold text-zinc-900 dark:text-white group-hover:text-emerald-500 transition-colors">
										ARCHITECTURE.md</h4>
									<p class="text-[10px] text-zinc-500 dark:text-zinc-400 leading-tight">Deep dive into
										technical stack and implementation details.</p>
								</div>
							</a>
						</div>
					</div>
				</div>

			</div>
		</div>
	</div>
</div>

{% include 'components/stats_modal.html' %}

<!-- DETAIL MODAL -->
<div id="detailModal"
	class="fixed inset-0 z-[60] flex items-center justify-center bg-zinc-500/30 dark:bg-black/95 backdrop-blur-md hidden opacity-0 transition-all duration-300"
	onclick="if(event.target === this) closeDetail()">
	<div id="detailModalContent"
		class="bg-white dark:bg-zinc-950 border-2 rounded-3xl w-full max-w-[95rem] h-[92vh] overflow-hidden flex flex-col shadow-2xl relative animate-enter transition-colors duration-300 border-zinc-200 dark:border-zinc-800">
		<button onclick="closeDetail()"
			class="absolute top-6 right-6 z-50 bg-black/10 dark:bg-black/40 hover:bg-zinc-200 dark:hover:bg-white text-zinc-900 dark:text-white hover:text-black p-2 rounded-full backdrop-blur-md transition-all border border-black/5 dark:border-white/10 hover:border-black/20 dark:hover:border-white shadow-lg"><i
				data-lucide="x" class="w-5 h-5"></i></button>
		<div id="detailContent" class="overflow-y-auto custom-scrollbar h-full relative"></div>
	</div>
</div>


<!-- ENTRY WIZARD MODAL -->
<div id="modal"
	class="fixed inset-0 z-[70] flex items-center justify-center bg-zinc-500/30 dark:bg-black/90 backdrop-blur-md hidden opacity-0 transition-opacity duration-200"
	onclick="if(event.target === this) closeModal()">
	<div class="bg-white dark:bg-[#0c0c0e] border border-zinc-200 dark:border-zinc-800 rounded-3xl w-full max-w-2xl h-[650px] max-h-[90vh] overflow-hidden flex flex-col shadow-2xl transform scale-95 transition-all duration-200 animate-enter"
		id="modalContent">
		<div
			class="px-8 py-6 border-b border-zinc-200 dark:border-zinc-800 flex justify-between items-center bg-white dark:bg-[#0c0c0e] relative">
			<h2 class="text-xl font-heading font-bold text-zinc-900 dark:text-white tracking-wide mx-auto"
				id="modalTitle">New Entry
			</h2>
			<button onclick="closeModal()"
				class="absolute right-8 text-zinc-400 hover:text-red-500 dark:hover:text-white transition-colors">
				<i data-lucide="x" class="w-5 h-5"></i>
			</button>
		</div>
		<div class="flex flex-1 overflow-hidden relative">
			<!-- Edit Mode Sidebar -->
			<div id="editSidebar"
				class="hidden w-64 shrink-0 bg-white dark:bg-[#0c0c0e] border-r border-zinc-200 dark:border-zinc-800 flex-col overflow-y-auto custom-scrollbar py-6 pl-6 pr-2">
				<nav class="space-y-1" id="editSidebarNav">
					<!-- Links populated by JS -->
				</nav>
			</div>

			<div id="formScrollWrapper"
				class="p-8 overflow-y-auto custom-scrollbar flex-1 bg-zinc-50 dark:bg-zinc-950/30 scroll-smooth">
				<form id="entryForm" class="h-full relative overflow-hidden" onsubmit="return false;">
					<!-- Step 1: Media Type -->
					<div id="step-1"
						class="wizard-step absolute inset-0 p-6 flex flex-col items-center justify-center text-center space-y-4 overflow-hidden">
						<h3
							class="edit-only-header hidden text-lg font-bold text-zinc-500 dark:text-zinc-400 uppercase tracking-widest mb-4">
							Media Type</h3>
						<div class="w-full h-full flex flex-col pb-2">
							<input type="hidden" id="type">
							<div id="typeSelectionContainer" class="w-full h-full"></div>
						</div>
					</div>

					<!-- Step 2: Status -->
					<div id="step-2"
						class="wizard-step absolute inset-0 p-6 flex flex-col items-center justify-center text-center space-y-4 hidden overflow-hidden">
						<h3
							class="edit-only-header hidden text-lg font-bold text-zinc-500 dark:text-zinc-400 uppercase tracking-widest mb-4">
							Status</h3>
						<input type="hidden" id="status">
						<div id="statusSelectionContainer" class="w-full h-full pb-2">
						</div>
					</div>

					<!-- Step 3: Cover Image -->
					<div id="step-3"
						class="wizard-step absolute inset-0 p-8 flex flex-col items-center justify-center text-center space-y-6 hidden">
						<div class="w-full max-w-md space-y-4">
							<div id="imagePreview"
								class="w-48 h-72 bg-white dark:bg-zinc-900 border-2 border-dashed border-zinc-300 dark:border-zinc-700 rounded-xl mx-auto flex items-center justify-center overflow-hidden relative group cursor-pointer transition-all hover:border-zinc-500 hover:bg-zinc-100 dark:hover:bg-zinc-800/50"
								onclick="document.getElementById('coverImage').click()">
								<input type="file" id="coverImage" accept="image/*" class="hidden"
									onchange="previewImage(this)">
								<div id="previewPlaceholder"
									class="flex flex-col items-center gap-3 text-zinc-400 dark:text-zinc-500 group-hover:text-zinc-600 dark:group-hover:text-zinc-300">
									<i data-lucide="image-plus" class="w-10 h-10"></i>
									<span class="text-xs font-bold uppercase tracking-wider">Upload</span>
								</div>
								<img id="previewImg" src="" class="absolute inset-0 w-full h-full object-cover hidden">
							</div>
							<div id="currentCoverName" class="text-xs text-zinc-500 font-mono"></div>
							<p class="text-xs text-zinc-500 dark:text-zinc-600">(Optional) Click to select an image</p>
						</div>
					</div>

					<!-- Step 4: Basic Info -->
					<div id="step-4"
						class="wizard-step absolute inset-0 p-8 flex flex-col hidden overflow-y-auto custom-scrollbar">
						<div class="space-y-6">
							<div class="space-y-2">
								<label class="text-xs font-bold text-zinc-500 uppercase tracking-wider ml-1">Title <span
										class="text-red-500">*</span></label>
								<input type="text" id="title" required
									class="w-full bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-5 py-4 text-xl font-heading font-bold text-zinc-900 dark:text-white outline-none focus:border-zinc-400 dark:focus:border-white/20 focus:ring-1 focus:ring-zinc-400 dark:focus:ring-white/20 placeholder:text-zinc-400 dark:placeholder:text-zinc-700 transition-all"
									placeholder="Enter title...">
							</div>

							<div class="space-y-2">
								<label class="text-xs font-bold text-zinc-500 uppercase tracking-wider ml-1">Alternate
									Titles <span
										class="text-zinc-400 dark:text-zinc-600 font-normal normal-case">(Optional)</span></label>
								<div class="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl p-3 flex flex-wrap gap-2 min-h-[54px] focus-within:border-zinc-400 dark:focus-within:border-zinc-600 focus-within:ring-1 focus:ring-zinc-400 dark:focus:ring-zinc-600 transition-all"
									id="altTitleTagsContainer">
									<input id="altTitleInput"
										class="bg-transparent text-sm outline-none flex-1 min-w-[80px] text-zinc-700 dark:text-zinc-200 p-1 placeholder-zinc-400"
										placeholder="Type & Enter...">
								</div>
							</div>

							<!-- Abbreviations / Shortcuts -->
							<div class="space-y-2">
								<label
									class="text-xs font-bold text-zinc-500 uppercase tracking-wider ml-1">Abbreviations
									/ Shortcuts <span
										class="text-zinc-400 dark:text-zinc-600 font-normal normal-case">(Optional)</span></label>
								<div class="flex gap-3">
									<label
										class="flex items-center justify-center bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-4 min-h-[54px] cursor-pointer group hover:border-zinc-400 dark:hover:border-zinc-600 transition-all"
										title="Disable Auto-Fill">
										<input type="checkbox" id="disableAbbr" checked
											class="w-4 h-4 rounded border-zinc-300 text-indigo-600 focus:ring-indigo-500 transition-all"
											onchange="toggleAbbrField(this.checked)">
										<span
											class="ml-2 text-[10px] font-bold text-zinc-400 group-hover:text-zinc-600 dark:group-hover:text-zinc-300 uppercase tracking-wider transition-colors hidden sm:inline-block">Disable
											Auto-Fill</span>
									</label>

									<div class="flex-1 bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl p-3 flex flex-wrap gap-2 min-h-[54px] focus-within:border-zinc-400 dark:focus-within:border-zinc-600 focus-within:ring-1 focus:ring-zinc-400 dark:focus:ring-zinc-600 transition-all"
										id="abbrTagsContainer">
										<input id="abbrInput"
											class="bg-transparent text-sm outline-none flex-1 min-w-[80px] text-zinc-700 dark:text-zinc-200 p-1 placeholder-zinc-400 shadow-none border-none ring-0"
											placeholder="Auto-filled from title...">
									</div>
								</div>
							</div>

							<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
								<div class="space-y-2">
									<label class="text-xs font-bold text-zinc-500 uppercase tracking-wider ml-1">Authors
										/ Studios <span
											class="text-zinc-400 dark:text-zinc-600 font-normal normal-case">(Optional)</span></label>
									<div class="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl p-3 flex flex-wrap gap-2 min-h-[54px] focus-within:border-zinc-400 dark:focus-within:border-zinc-600 focus-within:ring-1 focus:ring-zinc-400 dark:focus:ring-zinc-600 transition-all"
										id="authorTagsContainer">
										<input id="authorInput" list="authorOptions"
											class="bg-transparent text-sm outline-none flex-1 min-w-[80px] text-zinc-700 dark:text-zinc-200 p-1 placeholder-zinc-400"
											placeholder="Type & Enter...">
									</div>
								</div>
								<div class="space-y-2">
									<label
										class="text-xs font-bold text-zinc-500 uppercase tracking-wider ml-1">Universe
										<span
											class="text-zinc-400 dark:text-zinc-600 font-normal normal-case">(Optional)</span></label>
									<input type="text" id="universe" list="universeOptions"
										class="w-full bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-4 py-3 text-zinc-700 dark:text-zinc-200 outline-none focus:border-zinc-400 dark:focus:border-zinc-600 focus:ring-1 focus:ring-zinc-400 dark:focus:ring-zinc-600 transition-all placeholder-zinc-400"
										placeholder="e.g. MCU, Cosmere">
								</div>
							</div>

							<div id="seriesWrapper" class="hidden space-y-2">
								<label
									class="text-xs font-bold text-emerald-600 dark:text-emerald-500 uppercase tracking-wider ml-1">Series
									/
									Collection <span
										class="text-zinc-400 dark:text-zinc-600 font-normal normal-case">(Optional)</span></label>
								<div class="flex gap-4">
									<input type="text" id="series" list="seriesOptions"
										class="flex-1 bg-white dark:bg-zinc-900 border border-emerald-500/30 dark:border-emerald-900/40 rounded-xl px-4 py-3 text-zinc-700 dark:text-zinc-200 outline-none focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500 transition-all placeholder-zinc-400"
										placeholder="Series Name">
									<input type="text" id="seriesNumber"
										class="w-24 bg-white dark:bg-zinc-900 border border-emerald-500/30 dark:border-emerald-900/40 rounded-xl px-2 py-3 text-zinc-700 dark:text-zinc-200 outline-none focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500 text-center transition-all placeholder-zinc-400"
										placeholder="# Vol">
								</div>
							</div>

							<input type="hidden" id="itemId">
						</div>
					</div>

					<!-- Step 5: Description -->
					<div id="step-5" class="wizard-step absolute inset-0 p-8 flex flex-col hidden">
						<h3
							class="edit-only-header hidden text-lg font-bold text-zinc-500 dark:text-zinc-400 uppercase tracking-widest mb-4">
							Description</h3>
						<textarea id="description" rows="12"
							class="flex-1 w-full bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-5 py-4 text-zinc-700 dark:text-zinc-300 outline-none focus:border-zinc-400 dark:focus:border-zinc-600 focus:ring-1 focus:ring-zinc-400 dark:focus:ring-zinc-600 resize-none custom-scrollbar transition-all leading-relaxed text-lg placeholder:text-zinc-400"
							placeholder="What is this about? (Optional)"></textarea>
					</div>

					<!-- Step 6: External Links -->
					<div id="step-6"
						class="wizard-step absolute inset-0 p-8 flex flex-col hidden overflow-y-auto custom-scrollbar">
						<h3
							class="edit-only-header hidden text-lg font-bold text-zinc-500 dark:text-zinc-400 uppercase tracking-widest mb-4">
							External Links</h3>
						<div class="space-y-6">
							<div id="dynamicLinkButtons" class="flex flex-wrap gap-3 mb-6"></div>

							<div
								class="flex justify-between items-center ml-1 border-b border-zinc-200 dark:border-zinc-800 pb-2">
								<label class="text-xs font-bold text-zinc-500 uppercase tracking-wider">Added
									Links <span
										class="text-zinc-400 dark:text-zinc-600 font-normal normal-case">(Optional)</span></label>
								<button type="button" onclick="addLink()"
									class="text-xs text-indigo-500 dark:text-indigo-400 hover:text-indigo-600 dark:hover:text-indigo-300 flex items-center gap-1 font-bold"><i
										data-lucide="plus" class="w-3 h-3"></i> Custom Link</button>
							</div>
							<div id="linksContainer" class="space-y-3"></div>
							<datalist id="linkNameOptions">
								<option value="MyAnimeList"></option>
								<option value="CSFD"></option>
								<option value="IMDB"></option>
								<option value="Wikipedia"></option>
								<option value="Fandom"></option>
								<option value="Goodreads"></option>
							</datalist>
						</div>
					</div>

					<!-- Step 7: Current Progress -->
					<div id="step-7"
						class="wizard-step absolute inset-0 p-8 flex flex-col items-center justify-center text-center space-y-8 hidden overflow-y-auto custom-scrollbar">
						<div class="space-y-4 w-full max-w-md">
							<label
								class="text-xs font-bold text-amber-600 dark:text-amber-500 uppercase tracking-wider ml-1">Current
								Progress <span
									class="text-zinc-400 dark:text-zinc-600 font-normal normal-case">(Optional)</span></label>
							<input type="text" id="progress"
								class="w-full bg-white dark:bg-zinc-900 border border-amber-500/30 dark:border-amber-900/40 rounded-xl px-4 py-3 text-zinc-700 dark:text-zinc-200 outline-none focus:border-amber-500 focus:ring-1 focus:ring-amber-500 transition-all font-mono text-center text-lg placeholder-zinc-400"
								placeholder="e.g. Ch10, S2, V1, S2E1...">
							<p class="text-xs text-zinc-500" id="progressHelp">Where you left off (Next
								chapter/volume/season/episode to continue from)</p>
						</div>
					</div>

					<!-- Step 8: Review & Rating -->
					<div id="step-8"
						class="wizard-step absolute inset-0 p-8 flex flex-col hidden overflow-y-auto custom-scrollbar">
						<div id="reviewWrapper" class="flex-1 flex flex-col w-full mb-8">
							<label
								class="text-xs font-bold text-indigo-500 dark:text-indigo-400 uppercase tracking-wider mb-2">Personal
								Review <span
									class="text-zinc-400 dark:text-zinc-600 font-normal normal-case">(Optional)</span></label>
							<textarea id="review"
								class="flex-1 w-full bg-white dark:bg-zinc-900 border border-indigo-200 dark:border-indigo-900/40 rounded-xl px-5 py-4 text-zinc-700 dark:text-zinc-300 outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 resize-none custom-scrollbar transition-all placeholder:text-zinc-400 dark:placeholder:text-zinc-700"
								placeholder="Write your comprehensive review..."></textarea>
						</div>

						<div class="space-y-8 w-full">
							<!-- Rating Visual Component -->
							<div class="relative w-full pt-6 pb-2">
								<!-- Star Legend -->
								<div class="grid grid-cols-4 px-0 mb-2 w-full">
									<div class="flex justify-center items-center">
										<i data-lucide="star" class="w-4 h-4 text-red-500 fill-red-500"></i>
									</div>
									<div class="flex justify-center items-center">
										<div class="flex gap-0.5">
											<i data-lucide="star" class="w-4 h-4 text-amber-500 fill-amber-500"></i>
											<i data-lucide="star" class="w-4 h-4 text-amber-500 fill-amber-500"></i>
										</div>
									</div>
									<div class="flex justify-center items-center">
										<div class="flex gap-0.5">
											<i data-lucide="star" class="w-4 h-4 text-blue-500 fill-blue-500"></i>
											<i data-lucide="star" class="w-4 h-4 text-blue-500 fill-blue-500"></i>
											<i data-lucide="star" class="w-4 h-4 text-blue-500 fill-blue-500"></i>
										</div>
									</div>
									<div class="flex justify-center items-center">
										<div class="flex gap-0.5">
											<i data-lucide="star" class="w-4 h-4 text-emerald-500 fill-emerald-500"></i>
											<i data-lucide="star" class="w-4 h-4 text-emerald-500 fill-emerald-500"></i>
											<i data-lucide="star" class="w-4 h-4 text-emerald-500 fill-emerald-500"></i>
											<i data-lucide="star" class="w-4 h-4 text-emerald-500 fill-emerald-500"></i>
										</div>
									</div>
								</div>

								<!-- Slider Container -->
								<div class="relative w-full h-4 mt-2">
									<!-- Custom Track Background -->
									<div
										class="absolute inset-0 w-full h-4 rounded-full overflow-hidden flex opacity-30 pointer-events-none">
										<div class="flex-1 bg-red-500"></div>
										<div class="flex-1 bg-amber-500"></div>
										<div class="flex-1 bg-blue-500"></div>
										<div class="flex-1 bg-emerald-500"></div>
									</div>

									<!-- Slider Input -->
									<input type="range" id="rating" min="1" max="4" step="1" value="2"
										class="relative z-10 w-[75%] mx-auto block h-4 bg-transparent rounded-full appearance-none cursor-pointer accent-amber-500 focus:outline-none">
								</div>
							</div>

							<!-- Dynamic Label -->
							<div class="text-center">
								<div id="ratingLabel"
									class="text-4xl font-black uppercase text-amber-500 dark:text-amber-400 tracking-tighter drop-shadow-2xl transition-all transform hover:scale-105">
									Ok</div>
							</div>
						</div>
					</div>

					<!-- Step 9: Notes -->
					<div id="step-9" class="wizard-step absolute inset-0 p-8 flex flex-col hidden">
						<h3
							class="edit-only-header hidden text-lg font-bold text-zinc-500 dark:text-zinc-400 uppercase tracking-widest mb-4">
							Notes</h3>
						<textarea id="notes" rows="12"
							class="flex-1 w-full bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl px-5 py-4 text-zinc-700 dark:text-zinc-300 outline-none focus:border-zinc-400 dark:focus:border-zinc-600 focus:ring-1 focus:ring-zinc-400 dark:focus:ring-zinc-600 resize-none custom-scrollbar transition-all leading-relaxed font-mono text-sm placeholder:text-zinc-400"
							placeholder="Private notes, reminders, or details... (Optional)"></textarea>
					</div>

					<!-- Step 10: Seasons/Volumes -->
					<div id="step-10" class="wizard-step absolute inset-0 p-8 flex flex-col hidden">
						<div class="flex justify-between items-center mb-6">
							<h3
								class="text-2xl font-heading font-bold text-zinc-900 dark:text-white flex items-center gap-3">
								<i data-lucide="layers" class="w-6 h-6 text-zinc-400 dark:text-zinc-600"></i> <span
									id="childLabel">Seasons</span>
							</h3>
							<button type="button" onclick="addChild()"
								class="bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded-lg text-xs font-bold uppercase tracking-wider transition-all shadow-lg flex items-center gap-2"><i
									data-lucide="plus" class="w-4 h-4"></i> Add New</button>
						</div>

						<div id="childrenWrapper"
							class="flex-1 bg-zinc-100 dark:bg-zinc-900/50 border border-zinc-200 dark:border-zinc-800 rounded-xl p-4 overflow-hidden flex flex-col">
							<div id="childrenContainer" class="flex-1 overflow-y-auto custom-scrollbar space-y-3 pr-2">
							</div>
						</div>
					</div>

					<!-- Step 11: Privacy Setting -->
					<div id="step-11"
						class="wizard-step absolute inset-0 p-8 flex flex-col items-center justify-center text-center space-y-8 hidden">
						<div class="space-y-6 w-full max-w-sm">
							<label for="isHidden"
								class="p-6 rounded-2xl bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 flex flex-col items-center gap-4 cursor-pointer hover:border-red-500/50 hover:bg-red-500/5 transition-all group shadow-xl">
								<div class="flex items-center gap-4 pointer-events-none">
									<input type="checkbox" id="isHidden"
										class="h-6 w-6 rounded border-zinc-300 dark:border-zinc-700 bg-zinc-100 dark:bg-zinc-800 text-red-500 focus:ring-red-500 transition-all pointer-events-auto">
									<span
										class="text-xl font-bold text-zinc-700 dark:text-zinc-300 group-hover:text-red-500 dark:group-hover:text-red-400 select-none">Mark
										as Hidden</span>
								</div>
								<p class="text-xs text-zinc-500 px-4 pointer-events-none">Hidden items are excluded from
									the public grid view by default.</p>
							</label>
						</div>
					</div>

					<!-- Datalists for Autocomplete -->
					<datalist id="authorOptions"></datalist>
					<datalist id="universeOptions"></datalist>
					<datalist id="seriesOptions"></datalist>

				</form>
			</div>
		</div>

		<!-- Wizard Footer Navigation -->
		<div
			class="px-8 py-5 border-t border-zinc-200 dark:border-zinc-800 flex justify-between items-center bg-white dark:bg-[#0c0c0e] relative z-50">
			<div class="flex gap-2 w-16 invisible"> <!-- Placeholder to balance layout -->
				<span id="stepIndicator" class="text-xs font-mono text-zinc-600 font-bold"></span>
			</div>

			<!-- Centered Dots Container -->
			<div id="wizardDots" class="absolute left-1/2 -translate-x-1/2 flex gap-3"></div>

			<div class="flex gap-3">
				<button type="button" id="prevBtn" onclick="prevStep()"
					class="hidden px-6 py-2.5 text-zinc-500 dark:text-zinc-400 hover:text-zinc-900 dark:hover:text-white text-sm font-bold transition-colors">Back</button>
				<button type="button" id="nextBtn" onclick="nextStep()"
					class="bg-zinc-900 dark:bg-white text-white dark:text-black hover:bg-zinc-700 dark:hover:bg-zinc-200 px-8 py-2.5 rounded-xl font-bold shadow-lg shadow-black/10 dark:shadow-white/10 text-sm active:scale-95 transition-all">Next</button>
				<button type="button" id="submitBtn" onclick="saveEntry()"
					class="hidden bg-zinc-900 dark:bg-white text-white dark:text-black hover:bg-zinc-700 dark:hover:bg-zinc-200 px-8 py-2.5 rounded-xl font-bold shadow-lg shadow-black/10 dark:shadow-white/10 text-sm active:scale-95 transition-all">Finish</button>
			</div>
		</div>
	</div>
</div>

<!-- EXPORT MODAL - Must be outside #modal -->
<div id="exportModal"
	class="fixed inset-0 z-[75] flex items-center justify-center bg-zinc-500/30 dark:bg-black/90 backdrop-blur-md hidden opacity-0 transition-opacity duration-200"
	onclick="if(event.target === this) closeExportModal()">

	<div class="bg-white dark:bg-[#0c0c0e] border border-zinc-200 dark:border-zinc-800 rounded-3xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col shadow-2xl transform scale-95 transition-all duration-200"
		id="exportContent">

		<div
			class="px-8 py-6 border-b border-zinc-200 dark:border-zinc-700/50 flex justify-between items-center bg-white dark:bg-[#0c0c0e]">
			<h2
				class="text-xl font-heading font-bold text-zinc-900 dark:text-white tracking-wide flex items-center gap-2">
				<i data-lucide="download" class="w-5 h-5 text-indigo-500 dark:text-indigo-400"></i> Export Library
			</h2>
			<button onclick="closeExportModal()"
				class="text-zinc-400 hover:text-red-500 dark:hover:text-white transition-colors">
				<i data-lucide="x" class="w-5 h-5"></i>
			</button>
		</div>

		<div class="p-8 space-y-6 bg-zinc-50 dark:bg-zinc-950/30 overflow-y-auto custom-scrollbar flex-1">
			<div class="space-y-4 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2">
				<p id="infoDescription" class="text-zinc-600 dark:text-zinc-300 text-sm leading-relaxed"></p>
				<!-- Notes Section -->
				<div id="infoNotesContainer" class="hidden">
					<h4
						class="text-xs font-bold text-zinc-400 dark:text-zinc-500 uppercase tracking-widest mb-1.5 flex items-center gap-1.5">
						<i data-lucide="sticky-note" class="w-3.5 h-3.5"></i> Notes
					</h4>
					<p id="infoNotes"
						class="text-zinc-600 dark:text-zinc-300 text-xs font-mono bg-zinc-100 dark:bg-zinc-900/50 p-3 rounded-lg border border-zinc-200 dark:border-white/5">
					</p>
				</div>
			</div>

			<!-- Step 1: Category Selection -->
			<div id="exportStep1" class="space-y-4">
				<label class="text-xs font-bold text-zinc-500 uppercase tracking-wider">Choose Export Type</label>
				<div class="grid grid-cols-3 gap-4">
					<div class="grid grid-cols-3 gap-4">
						<button type="button" onclick="selectExportCategory('visual')"
							class="export-category-tile group bg-white dark:bg-zinc-900 border-2 border-zinc-200 dark:border-zinc-800 hover:border-indigo-500/50 rounded-2xl p-5 flex flex-col items-center gap-3 transition-all hover:bg-indigo-50 dark:hover:bg-indigo-500/5"
							data-category="visual">
							<div
								class="w-12 h-12 rounded-xl bg-indigo-50 dark:bg-indigo-500/10 border border-indigo-200 dark:border-indigo-500/30 flex items-center justify-center group-hover:bg-indigo-100 dark:group-hover:bg-indigo-500/20 transition-all">
								<i data-lucide="file-image" class="w-6 h-6 text-indigo-500 dark:text-indigo-400"></i>
							</div>
							<div class="text-center">
								<h3 class="text-base font-bold text-zinc-900 dark:text-white mb-1">Visual Export</h3>
								<p class="text-[10px] text-zinc-500 leading-tight">HTML formats with styled layouts</p>
							</div>
						</button>

						</button>

						<button type="button" onclick="selectExportCategory('raw')"
							class="export-category-tile group bg-white dark:bg-zinc-900 border-2 border-zinc-200 dark:border-zinc-800 hover:border-emerald-500/50 rounded-2xl p-5 flex flex-col items-center gap-3 transition-all hover:bg-emerald-50 dark:hover:bg-emerald-500/5"
							data-category="raw">
							<div
								class="w-12 h-12 rounded-xl bg-emerald-50 dark:bg-emerald-500/10 border border-emerald-200 dark:border-emerald-500/30 flex items-center justify-center group-hover:bg-emerald-100 dark:group-hover:bg-emerald-500/20 transition-all">
								<i data-lucide="database" class="w-6 h-6 text-emerald-500 dark:text-emerald-400"></i>
							</div>
							<div class="text-center">
								<h3 class="text-base font-bold text-zinc-900 dark:text-white mb-1">Raw Data</h3>
								<p class="text-[10px] text-zinc-500 leading-tight">JSON/CSV/XML for backup or migration
								</p>
							</div>
						</button>

						</button>

						<button type="button" onclick="selectExportCategory('full')"
							class="export-category-tile group bg-white dark:bg-zinc-900 border-2 border-zinc-200 dark:border-zinc-800 hover:border-amber-500/50 rounded-2xl p-5 flex flex-col items-center gap-3 transition-all hover:bg-amber-50 dark:hover:bg-amber-500/5"
							data-category="full">
							<div
								class="w-12 h-12 rounded-xl bg-amber-50 dark:bg-amber-500/10 border border-amber-200 dark:border-amber-500/30 flex items-center justify-center group-hover:bg-amber-100 dark:group-hover:bg-amber-500/20 transition-all">
								<i data-lucide="package" class="w-6 h-6 text-amber-500 dark:text-amber-400"></i>
							</div>
							<div class="text-center">
								<h3 class="text-base font-bold text-zinc-900 dark:text-white mb-1">Full Export</h3>
								<p class="text-[10px] text-zinc-500 leading-tight">Complete app backup with all files
								</p>
							</div>
						</button>
					</div>
				</div>

				<!-- Step 2: Format & Options (Hidden initially) -->
				<div id="exportStep2" class="hidden space-y-6">

					<button type="button" onclick="backToExportCategories()"
						class="flex items-center gap-2 text-zinc-400 hover:text-zinc-900 dark:hover:text-white text-sm font-medium transition-colors">
						<i data-lucide="arrow-left" class="w-4 h-4"></i> Back to export types
					</button>

					<!-- Visual Export Options -->
					<div id="visualExportOptions" class="hidden space-y-6">
						<div class="space-y-3">
							<label
								class="text-xs font-bold text-indigo-500 dark:text-indigo-400 uppercase tracking-wider">Select
								View
								Style</label>
							<div class="grid grid-cols-3 gap-3">
								<label class="cursor-pointer group">
									<input type="radio" name="visualFormat" value="html_accordion" class="peer hidden"
										checked onchange="updateExportOptions()">
									<div
										class="bg-white dark:bg-zinc-900 border-2 border-zinc-200 dark:border-zinc-800 p-4 rounded-xl flex flex-col items-center gap-3 peer-checked:border-indigo-500 peer-checked:bg-indigo-50 dark:peer-checked:bg-indigo-500/10 text-zinc-400 peer-checked:text-indigo-500 dark:peer-checked:text-indigo-400 transition-all hover:bg-zinc-50 dark:hover:bg-zinc-800">
										<i data-lucide="list-collapse" class="w-6 h-6"></i>
										<div class="text-center">
											<span
												class="text-sm font-bold block text-zinc-700 dark:text-zinc-200">Simple
												List</span>
											<span class="text-[10px] text-zinc-500">Expandable rows</span>
										</div>
									</div>
								</label>

								<label class="cursor-pointer group">
									<input type="radio" name="visualFormat" value="html_list" class="peer hidden"
										onchange="updateExportOptions()">
									<div
										class="bg-white dark:bg-zinc-900 border-2 border-zinc-200 dark:border-zinc-800 p-4 rounded-xl flex flex-col items-center gap-3 peer-checked:border-indigo-500 peer-checked:bg-indigo-50 dark:peer-checked:bg-indigo-500/10 text-zinc-400 peer-checked:text-indigo-500 dark:peer-checked:text-indigo-400 transition-all hover:bg-zinc-50 dark:hover:bg-zinc-800">
										<i data-lucide="layout-list" class="w-6 h-6"></i>
										<div class="text-center">
											<span
												class="text-sm font-bold block text-zinc-700 dark:text-zinc-200">Detailed
												List</span>
											<span class="text-[10px] text-zinc-500">Full info rows</span>
										</div>
									</div>
								</label>

								<label class="cursor-pointer group">
									<input type="radio" name="visualFormat" value="html_card" class="peer hidden"
										onchange="updateExportOptions()">
									<div
										class="bg-white dark:bg-zinc-900 border-2 border-zinc-200 dark:border-zinc-800 p-4 rounded-xl flex flex-col items-center gap-3 peer-checked:border-indigo-500 peer-checked:bg-indigo-50 dark:peer-checked:bg-indigo-500/10 text-zinc-400 peer-checked:text-indigo-500 dark:peer-checked:text-indigo-400 transition-all hover:bg-zinc-50 dark:hover:bg-zinc-800">
										<i data-lucide="layout-grid" class="w-6 h-6"></i>
										<div class="text-center">
											<span class="text-sm font-bold block text-zinc-700 dark:text-zinc-200">Card
												Grid</span>
											<span class="text-[10px] text-zinc-500">Visual covers</span>
										</div>
									</div>
								</label>
							</div>
						</div>

						<!-- Fields Selection -->
						<label class="text-xs font-bold text-zinc-500 uppercase tracking-wider">Included
							Fields</label>
						<div id="visualFieldsContainer" class="grid grid-cols-3 gap-2">
							<!-- Populated by JS -->
						</div>
					</div>

					<!-- Raw Data Export Options -->
					<div id="rawExportOptions" class="hidden space-y-6">
						<div
							class="bg-emerald-50 dark:bg-emerald-500/10 border border-emerald-200 dark:border-emerald-500/30 rounded-xl p-4 flex items-center gap-3">
							<i data-lucide="database"
								class="w-5 h-5 text-emerald-500 dark:text-emerald-400 shrink-0"></i>
							<div>
								<span class="text-sm font-medium text-emerald-600 dark:text-emerald-300">Currently
									using:
									<strong>SQLite</strong> Database</span>
								<p class="text-xs text-zinc-500 dark:text-zinc-400 mt-0.5">This is your primary data
									file.
									Share this
									format to preserve your full library.</p>
							</div>
						</div>

						<div class="space-y-3">
							<label
								class="text-xs font-bold text-emerald-500 dark:text-emerald-400 uppercase tracking-wider">Select
								Data
								Format</label>
							<div class="grid grid-cols-2 gap-3 sm:grid-cols-4">
								<label class="cursor-pointer group">
									<input type="radio" name="rawFormat" value="db" class="peer hidden" checked
										onchange="updateExportOptions()">
									<div
										class="bg-white dark:bg-zinc-900 border-2 border-zinc-200 dark:border-zinc-800 p-4 rounded-xl flex flex-col items-center gap-3 peer-checked:border-emerald-500 peer-checked:bg-emerald-50 dark:peer-checked:bg-emerald-500/10 text-zinc-400 peer-checked:text-emerald-500 dark:peer-checked:text-emerald-400 transition-all hover:bg-zinc-50 dark:hover:bg-zinc-800 h-full">
										<i data-lucide="database" class="w-6 h-6"></i>
										<div class="text-center">
											<span
												class="text-sm font-bold block text-zinc-700 dark:text-zinc-200">SQLite</span>
											<span class="text-[10px] text-zinc-500">Raw DB</span>
										</div>
									</div>
								</label>

								<label class="cursor-pointer group">
									<input type="radio" name="rawFormat" value="json_raw" class="peer hidden"
										onchange="updateExportOptions()">
									<div
										class="bg-white dark:bg-zinc-900 border-2 border-zinc-200 dark:border-zinc-800 p-4 rounded-xl flex flex-col items-center gap-3 peer-checked:border-emerald-500 peer-checked:bg-emerald-50 dark:peer-checked:bg-emerald-500/10 text-zinc-400 peer-checked:text-emerald-500 dark:peer-checked:text-emerald-400 transition-all hover:bg-zinc-50 dark:hover:bg-zinc-800 relative h-full">
										<i data-lucide="file-json" class="w-6 h-6"></i>
										<div class="text-center">
											<span
												class="text-sm font-bold block text-zinc-700 dark:text-zinc-200">JSON</span>
											<span class="text-[10px] text-zinc-500">Universal</span>
										</div>
									</div>
								</label>

								<label class="cursor-pointer group">
									<input type="radio" name="rawFormat" value="csv" class="peer hidden"
										onchange="updateExportOptions()">
									<div
										class="bg-white dark:bg-zinc-900 border-2 border-zinc-200 dark:border-zinc-800 p-4 rounded-xl flex flex-col items-center gap-3 peer-checked:border-emerald-500 peer-checked:bg-emerald-50 dark:peer-checked:bg-emerald-500/10 text-zinc-400 peer-checked:text-emerald-500 dark:peer-checked:text-emerald-400 transition-all hover:bg-zinc-50 dark:hover:bg-zinc-800 h-full">
										<i data-lucide="file-spreadsheet" class="w-6 h-6"></i>
										<div class="text-center">
											<span
												class="text-sm font-bold block text-zinc-700 dark:text-zinc-200">CSV</span>
											<span class="text-[10px] text-zinc-500">Excel</span>
										</div>
									</div>
								</label>

								<label class="cursor-pointer group">
									<input type="radio" name="rawFormat" value="xml" class="peer hidden"
										onchange="updateExportOptions()">
									<div
										class="bg-white dark:bg-zinc-900 border-2 border-zinc-200 dark:border-zinc-800 p-4 rounded-xl flex flex-col items-center gap-3 peer-checked:border-emerald-500 peer-checked:bg-emerald-50 dark:peer-checked:bg-emerald-500/10 text-zinc-400 peer-checked:text-emerald-500 dark:peer-checked:text-emerald-400 transition-all hover:bg-zinc-50 dark:hover:bg-zinc-800 h-full">
										<i data-lucide="file-code" class="w-6 h-6"></i>
										<div class="text-center">
											<span
												class="text-sm font-bold block text-zinc-700 dark:text-zinc-200">XML</span>
											<span class="text-[10px] text-zinc-500">Markup</span>
										</div>
									</div>
								</label>
							</div>
						</div>

						<!-- Fields Selection for Raw Data -->
						<label class="text-xs font-bold text-zinc-500 uppercase tracking-wider">Included
							Fields</label>
						<div id="rawFieldsContainer" class="grid grid-cols-3 gap-2">
							<!-- Populated by JS -->
						</div>
					</div>

					<!-- Full Export Options -->
					<div id="fullExportOptions" class="hidden space-y-6">
						<div
							class="bg-amber-50 dark:bg-amber-500/5 border border-amber-200 dark:border-amber-500/20 rounded-xl p-5 space-y-4">
							<div class="flex items-start gap-4">
								<div
									class="shrink-0 w-10 h-10 rounded-lg bg-amber-500/20 flex items-center justify-center text-amber-600 dark:text-amber-500">
									<i data-lucide="archive" class="w-5 h-5"></i>
								</div>
								<div>
									<h3
										class="text-sm font-bold text-zinc-900 dark:text-zinc-100 uppercase tracking-wide">
										Complete System Backup</h3>
									<p class="text-xs text-zinc-500 dark:text-zinc-400 mt-1 leading-relaxed">
										Generates a standalone ZIP package containing:
									</p>
									<ul class="text-zinc-500 space-y-1 mt-2">
										<li class="flex items-center gap-1.5"><i data-lucide="check"
												class="w-3 h-3 text-emerald-500 dark:text-emerald-400"></i> Source Code
										</li>
										<li class="flex items-center gap-1.5"><i data-lucide="check"
												class="w-3 h-3 text-emerald-500 dark:text-emerald-400"></i> CSS &
											JavaScript
										</li>
										<li class="flex items-center gap-1.5"><i data-lucide="check"
												class="w-3 h-3 text-emerald-500 dark:text-emerald-400"></i>
											Requirements.txt
										</li>
									</ul>

									<div
										class="mt-4 bg-white dark:bg-zinc-900/50 rounded-lg p-3 border border-zinc-200 dark:border-zinc-800">
										<div
											class="flex items-center gap-2 text-amber-500 dark:text-amber-400 font-bold mb-2">
											<i data-lucide="database" class="w-4 h-4"></i>
											<span>Your Data</span>
										</div>
										<ul class="text-zinc-500 space-y-1">
											<li class="flex items-center gap-1.5"><i data-lucide="check"
													class="w-3 h-3 text-emerald-500 dark:text-emerald-400"></i> SQLite
												Database
												(library.db)</li>
											<li class="flex items-center gap-1.5"><i data-lucide="check"
													class="w-3 h-3 text-emerald-500 dark:text-emerald-400"></i> Embedded
												Cover
												Images
											</li>
										</ul>
									</div>
								</div>
							</div>

							<p class="text-[10px] text-zinc-600 italic flex items-center gap-1.5">
								<i data-lucide="info" class="w-3 h-3"></i>
								Extract the ZIP and run <code
									class="bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded text-amber-600 dark:text-amber-400">python manage.py run</code>
								to
								start the application
							</p>
						</div>
					</div>

					<!-- Filter Options (Shared) -->
					<div id="exportFilters" class="space-y-4 border-t border-zinc-200 dark:border-zinc-800 pt-6">
						<label class="text-xs font-bold text-zinc-500 uppercase tracking-wider">Filter Exports</label>

						<!-- Media Type Filter -->
						<div class="space-y-2">
							<span class="text-xs text-zinc-400 font-medium">Media Type</span>
							<div id="exportTypeFilters" class="grid grid-cols-3 sm:grid-cols-6 gap-2">
								<!-- Populated by JS as tiles with icons -->
							</div>
						</div>

						<!-- Status Filter -->
						<div class="space-y-2">
							<span class="text-xs text-zinc-400 font-medium">Status</span>
							<div id="exportStatusFilters" class="grid grid-cols-3 sm:grid-cols-4 lg:grid-cols-7 gap-2">
								<!-- Populated by JS as tiles with icons -->
							</div>
						</div>

						<!-- Rating Filter (conditionally shown) -->
						<div id="exportRatingSection" class="space-y-2 hidden">
							<div class="flex items-center justify-between">
								<span class="text-xs text-zinc-400 font-medium">Rating</span>
								<span class="text-[10px] text-zinc-500 italic">Planning items are always included</span>
							</div>
							<div id="exportRatingFilters" class="grid grid-cols-5 gap-2">
								<!-- Populated by JS as tiles -->
							</div>
							<p class="text-[10px] text-amber-500/80 flex items-center gap-1">
								<i data-lucide="info" class="w-3 h-3"></i>
								Rating filter only applies to items with a rating. Planning items without ratings are
								always included.
							</p>
						</div>
					</div>
				</div>

			</div>

			<!-- Footer (changes based on step) -->
			<div id="exportFooter"
				class="p-6 border-t border-zinc-200 dark:border-zinc-800 bg-white dark:bg-[#0c0c0e] flex justify-end hidden">
				<button onclick="triggerExport()"
					class="bg-zinc-900 dark:bg-white text-white dark:text-black hover:bg-zinc-700 dark:hover:bg-zinc-200 px-6 py-2.5 rounded-xl font-bold shadow-lg shadow-black/10 dark:shadow-white/10 text-sm active:scale-95 transition-all flex items-center gap-2">
					<i data-lucide="download" class="w-4 h-4"></i> Download ZIP
				</button>
			</div>
		</div>
	</div>